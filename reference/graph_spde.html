<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>'INLA' implementation of Whittle-Matérn fields for metric graphs — graph_spde • MetricGraph</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="'INLA' implementation of Whittle-Matérn fields for metric graphs — graph_spde"><meta name="description" content="This function creates an 'INLA' object that can be used
in 'INLA' or 'inlabru' to fit Whittle-Matérn fields on metric graphs."><meta property="og:description" content="This function creates an 'INLA' object that can be used
in 'INLA' or 'inlabru' to fit Whittle-Matérn fields on metric graphs."><meta property="og:image" content="https://davidbolin.github.io/MetricGraph/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MetricGraph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MetricGraph.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/metric_graph.html">Working with metric graphs</a></li>
    <li><a class="dropdown-item" href="../articles/random_fields.html">Gaussian random fields on metric graphs</a></li>
    <li><a class="dropdown-item" href="../articles/metric_graph_data.html">Data manipulation on metric graphs</a></li>
    <li><a class="dropdown-item" href="../articles/inlabru_interface.html">inlabru interface of Whittle--Matern fields</a></li>
    <li><a class="dropdown-item" href="../articles/inla_interface.html">INLA interface of Whittle--Matern fields</a></li>
    <li><a class="dropdown-item" href="../articles/fem_models.html">Whittle--Matern fields with general smoothness</a></li>
    <li><a class="dropdown-item" href="../articles/pointprocess.html">Log-Gaussian Cox processes on metric graphs</a></li>
    <li><a class="dropdown-item" href="../articles/comparison.html">Comparison of different models using real data</a></li>
    <li><a class="dropdown-item" href="../articles/isotropic_noneuclidean.html">On isotropic covariances on metric graphs with non-Euclidean edges</a></li>
    <li><a class="dropdown-item" href="../articles/multi_likelihood.html">An example with multiple likelihoods in INLA and inlabru</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/davidbolin/MetricGraph/discussions"><span class="fa fa-comments-o"></span> Discussions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/davidbolin/MetricGraph/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/jdavidbolin" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>'INLA' implementation of Whittle-Matérn fields for metric graphs</h1>
      <small class="dont-index">Source: <a href="https://github.com/davidbolin/MetricGraph/blob/devel/R/graph_spde.R" class="external-link"><code>R/graph_spde.R</code></a></small>
      <div class="d-none name"><code>graph_spde.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates an 'INLA' object that can be used
in 'INLA' or 'inlabru' to fit Whittle-Matérn fields on metric graphs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">graph_spde</span><span class="op">(</span></span>
<span>  <span class="va">graph_object</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  stationary_endpoints <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  parameterization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"matern"</span>, <span class="st">"spde"</span><span class="op">)</span>,</span>
<span>  start_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_kappa <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior_kappa <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior_sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_tau <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior_tau <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shared_lib <span class="op">=</span> <span class="st">"detect"</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-graph-object">graph_object<a class="anchor" aria-label="anchor" href="#arg-graph-object"></a></dt>
<dd><p>A <code>metric_graph</code> object.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>The order of the SPDE.</p></dd>


<dt id="arg-stationary-endpoints">stationary_endpoints<a class="anchor" aria-label="anchor" href="#arg-stationary-endpoints"></a></dt>
<dd><p>Which vertices of degree 1 should contain
stationary boundary conditions? Set to "all" for all vertices of degree 1, "none" for none of the vertices of degree 1, or pass the indices of the vertices of degree 1 for which stationary conditions are desired.</p></dd>


<dt id="arg-parameterization">parameterization<a class="anchor" aria-label="anchor" href="#arg-parameterization"></a></dt>
<dd><p>Which parameterization to be used? The options are
'matern' (sigma and range) and 'spde' (sigma and kappa).</p></dd>


<dt id="arg-start-range">start_range<a class="anchor" aria-label="anchor" href="#arg-start-range"></a></dt>
<dd><p>Starting value for range parameter.</p></dd>


<dt id="arg-prior-range">prior_range<a class="anchor" aria-label="anchor" href="#arg-prior-range"></a></dt>
<dd><p>a <code>list</code> containing the elements <code>meanlog</code> and
<code>sdlog</code>, that is, the mean and standard deviation of the range parameter on
the log scale. Will not be used if prior.kappa is non-null.</p></dd>


<dt id="arg-start-kappa">start_kappa<a class="anchor" aria-label="anchor" href="#arg-start-kappa"></a></dt>
<dd><p>Starting value for kappa.</p></dd>


<dt id="arg-prior-kappa">prior_kappa<a class="anchor" aria-label="anchor" href="#arg-prior-kappa"></a></dt>
<dd><p>a <code>list</code> containing the elements <code>meanlog</code> and
<code>sdlog</code>, that is, the mean and standard deviation of kappa on the log scale.</p></dd>


<dt id="arg-start-sigma">start_sigma<a class="anchor" aria-label="anchor" href="#arg-start-sigma"></a></dt>
<dd><p>Starting value for sigma.</p></dd>


<dt id="arg-prior-sigma">prior_sigma<a class="anchor" aria-label="anchor" href="#arg-prior-sigma"></a></dt>
<dd><p>a <code>list</code> containing the elements <code>meanlog</code> and
<code>sdlog</code>, that is, the mean and standard deviation of sigma on the log scale.</p></dd>


<dt id="arg-start-tau">start_tau<a class="anchor" aria-label="anchor" href="#arg-start-tau"></a></dt>
<dd><p>Starting value for tau.</p></dd>


<dt id="arg-prior-tau">prior_tau<a class="anchor" aria-label="anchor" href="#arg-prior-tau"></a></dt>
<dd><p>a <code>list</code> containing the elements <code>meanlog</code> and
<code>sdlog</code>, that is, the mean and standard deviation of tau on the log scale.</p></dd>


<dt id="arg-shared-lib">shared_lib<a class="anchor" aria-label="anchor" href="#arg-shared-lib"></a></dt>
<dd><p>Which shared lib to use for the cgeneric implementation?
If "detect", it will check if the shared lib exists locally, in which case it will
use it. Otherwise it will use 'INLA's shared library.
If 'INLA', it will use the shared lib from 'INLA's installation. If 'rSPDE', then
it will use the local installation of the rSPDE package (does not work if your installation is from CRAN).
Otherwise, you can directly supply the path of the .so (or .dll) file.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>Should debug be displayed?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An 'INLA' object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is used to construct a Matern SPDE model on a metric graph.
The latent field \(u\) is the solution of the SPDE
$$(\kappa^2 - \Delta)^\alpha u = \sigma W,$$ where \(W\) is Gaussian
white noise on the metric graph. This model implements exactly
the cases in which \(\alpha = 1\) or \(\alpha = 2\). For a finite
element approximation for general \(\alpha\) we refer the reader to the
'rSPDE' package and to the Whittle–Matérn fields with general smoothness vignette.</p>
<p>We also have the alternative parameterization \(\rho = \frac{\sqrt{8(\alpha-0.5)}}{\kappa}\),
which can be interpreted as a range parameter.</p>
<p>Let \(\kappa_0\) and \(\sigma_0\) be the starting values for \(\kappa\) and
\(\sigma\), we write \(\sigma = \exp\{\theta_1\}\) and \(\kappa = \exp\{\theta_2\}\).
We assume priors on \(\theta_1\) and \(\theta_2\) to be normally distributed
with mean, respectively, \(\log(\sigma_0)\) and \(\log(\kappa_0)\), and variance 10.
Similarly, if we let \(\rho_0\) be the starting value for \(\rho\), then
we write \(\rho = \exp\{\theta_2\}\) and assume a normal prior for \(\theta_2\),
with mean \(\log(\rho_0)\) and variance 10.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Bolin, Alexandre Simas, Jonas Wallin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

