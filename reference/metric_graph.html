<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Class representing a general metric graph."><title>Metric graph — metric_graph • MetricGraph</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto_Slab-0.4.7/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Metric graph — metric_graph"><meta property="og:description" content="Class representing a general metric graph."><meta property="og:image" content="https://davidbolin.github.io/MetricGraph/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MetricGraph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MetricGraph.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/metric_graph.html">Working with metric graphs</a>
    <a class="dropdown-item" href="../articles/random_fields.html">Gaussian random fields on metric graphs</a>
    <a class="dropdown-item" href="../articles/metric_graph_data.html">Data manipulation on metric graphs</a>
    <a class="dropdown-item" href="../articles/inlabru_interface.html">inlabru interface of Whittle--Matérn fields</a>
    <a class="dropdown-item" href="../articles/inla_interface.html">INLA interface of Whittle--Matérn fields</a>
    <a class="dropdown-item" href="../articles/fem_models.html">Whittle--Matérn fields with general smoothness</a>
    <a class="dropdown-item" href="../articles/pointprocess.html">Log-Gaussian Cox processes on metric graphs</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/davidbolin/MetricGraph/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/jdavidbolin" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Metric graph</h1>
      <small class="dont-index">Source: <a href="https://github.com/davidbolin/MetricGraph/blob/HEAD/R/metric_graph.R" class="external-link"><code>R/metric_graph.R</code></a></small>
      <div class="d-none name"><code>metric_graph.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Class representing a general metric graph.</p>
    </div>


    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Object of <code><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></code> for creating metric graphs.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A graph object created from vertex and edge matrices, or from an
<code><a href="https://rdrr.io/pkg/sp/man/SpatialLines.html" class="external-link">sp::SpatialLines</a></code> object where each line is representing and edge. For more details,
see the vignette:
<code><a href="../articles/metric_graph.html">vignette("metric_graph", package = "MetricGraph")</a></code></p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>V</code></dt>
<dd><p>Matrix with positions in Euclidean space of the vertices of the
graph.</p></dd>


<dt><code>nV</code></dt>
<dd><p>The number of vertices.</p></dd>


<dt><code>E</code></dt>
<dd><p>Matrix with the edges of the graph, where each row represents an
edge, <code>E[i,1]</code> is the vertex at the start of the ith edge and <code>E[i,2]</code> is
the vertex at the end of the edge.</p></dd>


<dt><code>nE</code></dt>
<dd><p>The number of edges.</p></dd>


<dt><code>edge_lengths</code></dt>
<dd><p>Vector with the lengths of the edges in the graph.</p></dd>


<dt><code>C</code></dt>
<dd><p>Constraint matrix used to set Kirchhoff constraints.</p></dd>


<dt><code>CoB</code></dt>
<dd><p>Change-of-basis object used for Kirchhoff constraints.</p></dd>


<dt><code>PtV</code></dt>
<dd><p>Vector with the indices of the vertices which are observation
locations.</p></dd>


<dt><code>mesh</code></dt>
<dd><p>Mesh object used for plotting.</p></dd>


<dt><code>edges</code></dt>
<dd><p>The coordinates of the edges in the graph.</p></dd>


<dt><code>geo_dist</code></dt>
<dd><p>Geodesic distances between the vertices in the graph.</p></dd>


<dt><code>res_dist</code></dt>
<dd><p>Resistance distances between the observation locations.</p></dd>


<dt><code>Laplacian</code></dt>
<dd><p>The weighted graph Laplacian of the vertices in the
graph. The weights are given by the edge lengths.</p></dd>


<dt><code>characteristics</code></dt>
<dd><p>List with various characteristics of the graph.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-metric_graph-new"><code>metric_graph$new()</code></a></p></li>
<li><p><a href="#method-metric_graph-print"><code>metric_graph$print()</code></a></p></li>
<li><p><a href="#method-metric_graph-compute_characteristics"><code>metric_graph$compute_characteristics()</code></a></p></li>
<li><p><a href="#method-metric_graph-check_euclidean"><code>metric_graph$check_euclidean()</code></a></p></li>
<li><p><a href="#method-metric_graph-check_distance_consistency"><code>metric_graph$check_distance_consistency()</code></a></p></li>
<li><p><a href="#method-metric_graph-compute_geodist"><code>metric_graph$compute_geodist()</code></a></p></li>
<li><p><a href="#method-metric_graph-compute_geodist_PtE"><code>metric_graph$compute_geodist_PtE()</code></a></p></li>
<li><p><a href="#method-metric_graph-compute_geodist_mesh"><code>metric_graph$compute_geodist_mesh()</code></a></p></li>
<li><p><a href="#method-metric_graph-compute_resdist"><code>metric_graph$compute_resdist()</code></a></p></li>
<li><p><a href="#method-metric_graph-compute_resdist_PtE"><code>metric_graph$compute_resdist_PtE()</code></a></p></li>
<li><p><a href="#method-metric_graph-get_degrees"><code>metric_graph$get_degrees()</code></a></p></li>
<li><p><a href="#method-metric_graph-compute_resdist_mesh"><code>metric_graph$compute_resdist_mesh()</code></a></p></li>
<li><p><a href="#method-metric_graph-compute_laplacian"><code>metric_graph$compute_laplacian()</code></a></p></li>
<li><p><a href="#method-metric_graph-prune_vertices"><code>metric_graph$prune_vertices()</code></a></p></li>
<li><p><a href="#method-metric_graph-get_groups"><code>metric_graph$get_groups()</code></a></p></li>
<li><p><a href="#method-metric_graph-get_PtE"><code>metric_graph$get_PtE()</code></a></p></li>
<li><p><a href="#method-metric_graph-get_edge_lengths"><code>metric_graph$get_edge_lengths()</code></a></p></li>
<li><p><a href="#method-metric_graph-get_locations"><code>metric_graph$get_locations()</code></a></p></li>
<li><p><a href="#method-metric_graph-observation_to_vertex"><code>metric_graph$observation_to_vertex()</code></a></p></li>
<li><p><a href="#method-metric_graph-get_mesh_locations"><code>metric_graph$get_mesh_locations()</code></a></p></li>
<li><p><a href="#method-metric_graph-clear_observations"><code>metric_graph$clear_observations()</code></a></p></li>
<li><p><a href="#method-metric_graph-process_data"><code>metric_graph$process_data()</code></a></p></li>
<li><p><a href="#method-metric_graph-add_observations"><code>metric_graph$add_observations()</code></a></p></li>
<li><p><a href="#method-metric_graph-mutate"><code>metric_graph$mutate()</code></a></p></li>
<li><p><a href="#method-metric_graph-drop_na"><code>metric_graph$drop_na()</code></a></p></li>
<li><p><a href="#method-metric_graph-select"><code>metric_graph$select()</code></a></p></li>
<li><p><a href="#method-metric_graph-filter"><code>metric_graph$filter()</code></a></p></li>
<li><p><a href="#method-metric_graph-summarise"><code>metric_graph$summarise()</code></a></p></li>
<li><p><a href="#method-metric_graph-get_data"><code>metric_graph$get_data()</code></a></p></li>
<li><p><a href="#method-metric_graph-buildC"><code>metric_graph$buildC()</code></a></p></li>
<li><p><a href="#method-metric_graph-build_mesh"><code>metric_graph$build_mesh()</code></a></p></li>
<li><p><a href="#method-metric_graph-compute_fem"><code>metric_graph$compute_fem()</code></a></p></li>
<li><p><a href="#method-metric_graph-mesh_A"><code>metric_graph$mesh_A()</code></a></p></li>
<li><p><a href="#method-metric_graph-fem_basis"><code>metric_graph$fem_basis()</code></a></p></li>
<li><p><a href="#method-metric_graph-VtEfirst"><code>metric_graph$VtEfirst()</code></a></p></li>
<li><p><a href="#method-metric_graph-plot"><code>metric_graph$plot()</code></a></p></li>
<li><p><a href="#method-metric_graph-plot_connections"><code>metric_graph$plot_connections()</code></a></p></li>
<li><p><a href="#method-metric_graph-is_tree"><code>metric_graph$is_tree()</code></a></p></li>
<li><p><a href="#method-metric_graph-plot_function"><code>metric_graph$plot_function()</code></a></p></li>
<li><p><a href="#method-metric_graph-plot_movie"><code>metric_graph$plot_movie()</code></a></p></li>
<li><p><a href="#method-metric_graph-add_mesh_observations"><code>metric_graph$add_mesh_observations()</code></a></p></li>
<li><p><a href="#method-metric_graph-get_initial_graph"><code>metric_graph$get_initial_graph()</code></a></p></li>
<li><p><a href="#method-metric_graph-coordinates"><code>metric_graph$coordinates()</code></a></p></li>
<li><p><a href="#method-metric_graph-clone"><code>metric_graph$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-metric_graph-new"></a><div class="section">
<h3 id="method-new-">Method <code><a href="https://rdrr.io/r/methods/new.html" class="external-link">new()</a></code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create a new <code>metric_graph</code> object.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/metric_graph.html">metric_graph</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  edges <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  V <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  E <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vertex_unit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  length_unit <span class="op">=</span> <span class="va">vertex_unit</span>,</span>
<span>  longlat <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  crs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  proj4string <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  which_longlat <span class="op">=</span> <span class="st">"sp"</span>,</span>
<span>  project <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  project_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  which_projection <span class="op">=</span> <span class="st">"Winkel tripel"</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>vertex_vertex <span class="op">=</span> <span class="fl">1e-07</span>, vertex_edge <span class="op">=</span> <span class="fl">1e-07</span>, edge_edge <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  check_connected <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  remove_deg2 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  merge_close_vertices <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  factor_merge_close_vertices <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  remove_circles <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lines <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>edges</code></dt>
<dd><p>A list containing coordinates as <code>m x 2</code> matrices (that is, of <code>matrix</code> type) or m x 2 data frames (<code>data.frame</code> type) of sequence of points connected by straightlines. Alternatively, you can also prove an object of type <code>SpatialLinesDataFrame</code> or <code>SpatialLines</code> (from <code>sp</code> package) or <code>MULTILINESTRING</code> (from <code>sf</code> package).</p></dd>


<dt><code>V</code></dt>
<dd><p>n x 2 matrix with Euclidean coordinates of the n vertices.</p></dd>


<dt><code>E</code></dt>
<dd><p>m x 2 matrix where each row represents one of the m edges.</p></dd>


<dt><code>vertex_unit</code></dt>
<dd><p>The unit in which the vertices are specified. The options are 'degrees' (the great circle distance in km), 'km', 'm' and 'miles'. The default is <code>NULL</code>, which means no unit. However, if you set <code>length_unit</code>, you need to set <code>vertex_unit</code>.</p></dd>


<dt><code>length_unit</code></dt>
<dd><p>The unit in which the lengths will be computed. The options are 'km', 'm' and 'miles'. The default is <code>vertex_unit</code>. Observe that if <code>vertex_unit</code> is <code>NULL</code>, <code>length_unit</code> can only be <code>NULL</code>.
If <code>vertex_unit</code> is 'degrees', then the default value for <code>length_unit</code> is 'km'.</p></dd>


<dt><code>longlat</code></dt>
<dd><p>If <code>TRUE</code>, then it is assumed that the coordinates are given.
in Longitude/Latitude and that distances should be computed in meters. If <code>TRUE</code> it takes precedence over
<code>vertex_unit</code> and <code>length_unit</code>, and is equivalent to <code>vertex_unit = 'degrees'</code> and <code>length_unit = 'm'</code>.</p></dd>


<dt><code>crs</code></dt>
<dd><p>Coordinate reference system to be used in case <code>longlat</code> is set to <code>TRUE</code> and <code>which_longlat</code> is <code>sf</code>. Object of class crs. The default is <code>sf::st_crs(4326)</code>.</p></dd>


<dt><code>proj4string</code></dt>
<dd><p>Projection string of class CRS-class to be used in case <code>longlat</code> is set to <code>TRUE</code> and <code>which_longlat</code> is <code>sp</code>. The default is <code>sp::CRS("+proj=longlat +datum=WGS84")</code>.</p></dd>


<dt><code>which_longlat</code></dt>
<dd><p>Compute the distance using which package? The options are <code>sp</code> and <code>sf</code>. The default is <code>sp</code>.</p></dd>


<dt><code>project</code></dt>
<dd><p>If <code>longlat</code> is <code>TRUE</code> should a projection be used to compute the distances to be used for the tolerances (see <code>tolerance</code> below)? The default is <code>TRUE</code>. When <code>TRUE</code>, the construction of the graph is faster.</p></dd>


<dt><code>project_data</code></dt>
<dd><p>If <code>longlat</code> is <code>TRUE</code> should the vertices be project to planar coordinates? The default is <code>FALSE</code>. When <code>TRUE</code>, the construction of the graph is faster.</p></dd>


<dt><code>which_projection</code></dt>
<dd><p>Which projection should be used in case <code>project</code> is <code>TRUE</code>? The options are <code>Robinson</code>, <code>Winkel tripel</code> or a proj4string. The default is <code>Winkel tripel</code>.</p></dd>


<dt><code>tolerance</code></dt>
<dd><p>List that provides tolerances during the construction of the graph:</p><ul><li><p><code>vertex_vertex</code> Vertices that are closer than this number are merged (default = 1e-7).</p></li>
<li><p><code>vertex_edge</code> If a vertex at the end of one edge is closer than this
number to another edge, this vertex is connected to that edge
(default = 1e-7). Previously <code>vertex_line</code>, which is now deprecated.</p></li>
<li><p><code>edge_edge</code> If two edges at some point are closer than this number, a new
vertex is added at that point and the two edges are connected (default = 0).</p></li>
<li><p><code>vertex_line</code>, Deprecated. Use <code>vertex_edge</code> instead.</p></li>
<li><p><code>line_line</code>, Deprecated. Use <code>edge_edge</code> instead.</p></li>
</ul><p>In case <code>longlat = TRUE</code>, the tolerances are given in <code>length_unit</code>.</p></dd>


<dt><code>check_connected</code></dt>
<dd><p>If <code>TRUE</code>, it is checked whether the graph is
connected and a warning is given if this is not the case.</p></dd>


<dt><code>remove_deg2</code></dt>
<dd><p>Set to <code>TRUE</code> to remove all vertices of degree 2 in the
initialization. Default is <code>FALSE</code>.</p></dd>


<dt><code>merge_close_vertices</code></dt>
<dd><p>should an additional step to merge close vertices be done?</p></dd>


<dt><code>factor_merge_close_vertices</code></dt>
<dd><p>Which factor to be multiplied by tolerance <code>vertex_vertex</code> when merging close vertices at the additional step?</p></dd>


<dt><code>remove_circles</code></dt>
<dd><p>All circlular edges with a length smaller than this number
are removed. If <code>TRUE</code>, the <code>vertex_vertex</code> tolerance will be used. If <code>FALSE</code>, no circles will be removed.</p></dd>


<dt><code>verbose</code></dt>
<dd><p>Print progress of graph creation.</p></dd>


<dt><code>lines</code></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> Use <code>edges</code> instead.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-1">Details<a class="anchor" aria-label="anchor" href="#details-1"></a></h4>
<p>A graph object can be initialized in two ways. The first method
is to specify V and E. In this case, all edges are assumed to be straight
lines. The second option is to specify the graph via the <code>lines</code> input.
In this case, the vertices are set by the end points of the lines.
Thus, if two lines are intersecting somewhere else, this will not be
viewed as a vertex.</p>
</div>

<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>A <code>metric_graph</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>Prints various characteristics of the graph</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>No return value. Called for its side effects.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-compute_characteristics"></a><div class="section">
<h3 id="method-compute-characteristics-">Method <code>compute_characteristics()</code><a class="anchor" aria-label="anchor" href="#method-compute-characteristics-"></a></h3>
<p>Computes various characteristics of the graph</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">compute_characteristics</span><span class="op">(</span>check_euclidean <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>check_euclidean</code></dt>
<dd><p>Also check if the graph has Euclidean edges? This essentially means that the distance consistency check will also be perfomed. If the graph does not have Euclidean edges due to another reason rather than the distance consistency, then it will already be indicated that the graph does not have Euclidean edges.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>No return value. Called for its side effects. The computed characteristics
are stored in the <code>characteristics</code> element of the <code>metric_graph</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-check_euclidean"></a><div class="section">
<h3 id="method-check-euclidean-">Method <code>check_euclidean()</code><a class="anchor" aria-label="anchor" href="#method-check-euclidean-"></a></h3>
<p>Check if the graph has Euclidean edges.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">check_euclidean</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>Returns <code>TRUE</code> if the graph has Euclidean edges, or <code>FALSE</code> otherwise.
The result is stored in the <code>characteristics</code> element of the <code>metric_graph</code> object.
The result is displayed when the graph is printed.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-check_distance_consistency"></a><div class="section">
<h3 id="method-check-distance-consistency-">Method <code>check_distance_consistency()</code><a class="anchor" aria-label="anchor" href="#method-check-distance-consistency-"></a></h3>
<p>Checks distance consistency of the graph.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">check_distance_consistency</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>No return value.
The result is stored in the <code>characteristics</code> element of the <code>metric_graph</code> object.
The result is displayed when the graph is printed.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-compute_geodist"></a><div class="section">
<h3 id="method-compute-geodist-">Method <code>compute_geodist()</code><a class="anchor" aria-label="anchor" href="#method-compute-geodist-"></a></h3>
<p>Computes shortest path distances between the vertices in the
graph</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">compute_geodist</span><span class="op">(</span>full <span class="op">=</span> <span class="cn">FALSE</span>, obs <span class="op">=</span> <span class="cn">TRUE</span>, group <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>full</code></dt>
<dd><p>Should the geodesic distances be computed for all
the available locations? If <code>FALSE</code>, it will be computed
separately for the locations of each group.</p></dd>


<dt><code>obs</code></dt>
<dd><p>Should the geodesic distances be computed at the observation
locations?</p></dd>


<dt><code>group</code></dt>
<dd><p>Vector or list containing which groups to compute the distance
for. If <code>NULL</code>, it will be computed for all groups.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a></h4>
<p>No return value. Called for its side effects. The computed geodesic
distances are stored in the <code>geo_dist</code> element of the <code>metric_graph</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-compute_geodist_PtE"></a><div class="section">
<h3 id="method-compute-geodist-pte-">Method <code>compute_geodist_PtE()</code><a class="anchor" aria-label="anchor" href="#method-compute-geodist-pte-"></a></h3>
<p>Computes shortest path distances between the vertices in the
graph.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">compute_geodist_PtE</span><span class="op">(</span></span>
<span>  <span class="va">PtE</span>,</span>
<span>  normalized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_vertices <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>PtE</code></dt>
<dd><p>Points to compute the metric for.</p></dd>


<dt><code>normalized</code></dt>
<dd><p>are the locations in PtE in normalized distance?</p></dd>


<dt><code>include_vertices</code></dt>
<dd><p>Should the original vertices be included in the
distance matrix?</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a></h4>
<p>A matrix containing the geodesic distances.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-compute_geodist_mesh"></a><div class="section">
<h3 id="method-compute-geodist-mesh-">Method <code>compute_geodist_mesh()</code><a class="anchor" aria-label="anchor" href="#method-compute-geodist-mesh-"></a></h3>
<p>Computes shortest path distances between the vertices in the
mesh.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">compute_geodist_mesh</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-7">Returns<a class="anchor" aria-label="anchor" href="#returns-7"></a></h4>
<p>No return value. Called for its side effects. The geodesic distances
on the mesh are stored in <code>mesh$geo_dist</code> in the <code>metric_graph</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-compute_resdist"></a><div class="section">
<h3 id="method-compute-resdist-">Method <code>compute_resdist()</code><a class="anchor" aria-label="anchor" href="#method-compute-resdist-"></a></h3>
<p>Computes the resistance distance between the observation
locations.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">compute_resdist</span><span class="op">(</span>full <span class="op">=</span> <span class="cn">FALSE</span>, obs <span class="op">=</span> <span class="cn">TRUE</span>, group <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>full</code></dt>
<dd><p>Should the resistance distances be computed for all
the available locations. If <code>FALSE</code>, it will be computed
separately for the locations of each group.</p></dd>


<dt><code>obs</code></dt>
<dd><p>Should the resistance distances be computed at the observation
locations?</p></dd>


<dt><code>group</code></dt>
<dd><p>Vector or list containing which groups to compute the distance
for. If <code>NULL</code>, it will be computed for all groups.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-8">Returns<a class="anchor" aria-label="anchor" href="#returns-8"></a></h4>
<p>No return value. Called for its side effects. The geodesic distances
are stored in the <code>res_dist</code> element of the <code>metric_graph</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-compute_resdist_PtE"></a><div class="section">
<h3 id="method-compute-resdist-pte-">Method <code>compute_resdist_PtE()</code><a class="anchor" aria-label="anchor" href="#method-compute-resdist-pte-"></a></h3>
<p>Computes the resistance distance between the observation
locations.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">compute_resdist_PtE</span><span class="op">(</span></span>
<span>  <span class="va">PtE</span>,</span>
<span>  normalized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_vertices <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>PtE</code></dt>
<dd><p>Points to compute the metric for.</p></dd>


<dt><code>normalized</code></dt>
<dd><p>Are the locations in PtE in normalized distance?</p></dd>


<dt><code>include_vertices</code></dt>
<dd><p>Should the original vertices be included in the
Laplacian matrix?</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-9">Returns<a class="anchor" aria-label="anchor" href="#returns-9"></a></h4>
<p>A matrix containing the resistance distances.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-get_degrees"></a><div class="section">
<h3 id="method-get-degrees-">Method <code>get_degrees()</code><a class="anchor" aria-label="anchor" href="#method-get-degrees-"></a></h3>
<p>Returns the degrees of the vertices in the metric graph.</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">get_degrees</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-10">Returns<a class="anchor" aria-label="anchor" href="#returns-10"></a></h4>
<p>A vector containing the degrees of the vertices.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-compute_resdist_mesh"></a><div class="section">
<h3 id="method-compute-resdist-mesh-">Method <code>compute_resdist_mesh()</code><a class="anchor" aria-label="anchor" href="#method-compute-resdist-mesh-"></a></h3>
<p>Computes the resistance metric between the vertices in the
mesh.</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">compute_resdist_mesh</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-11">Returns<a class="anchor" aria-label="anchor" href="#returns-11"></a></h4>
<p>No return value. Called for its side effects. The geodesic distances
on the mesh are stored in the <code>mesh$res_dist</code> element in the <code>metric_graph</code>
object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-compute_laplacian"></a><div class="section">
<h3 id="method-compute-laplacian-">Method <code>compute_laplacian()</code><a class="anchor" aria-label="anchor" href="#method-compute-laplacian-"></a></h3>
<p>Computes the weigthed graph Laplacian for the graph.</p><div class="section">
<h4 id="usage-12">Usage<a class="anchor" aria-label="anchor" href="#usage-12"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">compute_laplacian</span><span class="op">(</span>full <span class="op">=</span> <span class="cn">FALSE</span>, obs <span class="op">=</span> <span class="cn">TRUE</span>, group <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>full</code></dt>
<dd><p>Should the resistance distances be computed for all
the available locations. If <code>FALSE</code>, it will be computed
separately for the locations of each group.</p></dd>


<dt><code>obs</code></dt>
<dd><p>Should the resistance distances be computed at the observation
locations? It will only compute for locations in which there is at least one observations that is not NA.</p></dd>


<dt><code>group</code></dt>
<dd><p>Vector or list containing which groups to compute the
Laplacian for. If <code>NULL</code>, it will be computed for all groups.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-12">Returns<a class="anchor" aria-label="anchor" href="#returns-12"></a></h4>
<p>No reutrn value. Called for its side effects. The Laplacian is stored
in the <code>Laplacian</code> element in the <code>metric_graph</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-prune_vertices"></a><div class="section">
<h3 id="method-prune-vertices-">Method <code>prune_vertices()</code><a class="anchor" aria-label="anchor" href="#method-prune-vertices-"></a></h3>
<p>Removes vertices of degree 2 from the metric graph.</p><div class="section">
<h4 id="usage-13">Usage<a class="anchor" aria-label="anchor" href="#usage-13"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">prune_vertices</span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>verbose</code></dt>
<dd><p>Show progress? Default is <code>FALSE</code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-2">Details<a class="anchor" aria-label="anchor" href="#details-2"></a></h4>
<p>Vertices of degree 2 are removed as long as the corresponding edges that
would be merged are compatible in terms of direction.</p>
</div>

<div class="section">
<h4 id="returns-13">Returns<a class="anchor" aria-label="anchor" href="#returns-13"></a></h4>
<p>No return value. Called for its side effects.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-get_groups"></a><div class="section">
<h3 id="method-get-groups-">Method <code>get_groups()</code><a class="anchor" aria-label="anchor" href="#method-get-groups-"></a></h3>
<p>Gets the groups from the data.</p><div class="section">
<h4 id="usage-14">Usage<a class="anchor" aria-label="anchor" href="#usage-14"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">get_groups</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-14">Returns<a class="anchor" aria-label="anchor" href="#returns-14"></a></h4>
<p>A vector containing the available groups in the internal data.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-get_PtE"></a><div class="section">
<h3 id="method-get-pte-">Method <code>get_PtE()</code><a class="anchor" aria-label="anchor" href="#method-get-pte-"></a></h3>
<p>Gets PtE from the data.</p><div class="section">
<h4 id="usage-15">Usage<a class="anchor" aria-label="anchor" href="#usage-15"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">get_PtE</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>group</code></dt>
<dd><p>For which group, should the PtE be returned? <code>NULL</code> means that all PtEs available will be returned.</p></dd>


<dt><code>include_group</code></dt>
<dd><p>Should the group be included as a column? If <code>TRUE</code>, the PtEs for each group will be concatenated, otherwise a single matrix containing the unique PtEs will be returned.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-15">Returns<a class="anchor" aria-label="anchor" href="#returns-15"></a></h4>
<p>A matrix with two columns, where the first column contains the edge
number and the second column contains the distance on edge of the
observation locations.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-get_edge_lengths"></a><div class="section">
<h3 id="method-get-edge-lengths-">Method <code>get_edge_lengths()</code><a class="anchor" aria-label="anchor" href="#method-get-edge-lengths-"></a></h3>
<p>Gets the edge lengths with the corresponding unit.</p><div class="section">
<h4 id="usage-16">Usage<a class="anchor" aria-label="anchor" href="#usage-16"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">get_edge_lengths</span><span class="op">(</span>unit <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>unit</code></dt>
<dd><p>If non-NULL, changes from <code>length_unit</code> from the graph construction to <code>unit</code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-16">Returns<a class="anchor" aria-label="anchor" href="#returns-16"></a></h4>
<p>a vector with the length unit (if the graph was constructed with a length unit).</p>
</div>

</div><p></p><hr><a id="method-metric_graph-get_locations"></a><div class="section">
<h3 id="method-get-locations-">Method <code>get_locations()</code><a class="anchor" aria-label="anchor" href="#method-get-locations-"></a></h3>
<p>Gets the spatial locations from the data.</p><div class="section">
<h4 id="usage-17">Usage<a class="anchor" aria-label="anchor" href="#usage-17"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">get_locations</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-17">Returns<a class="anchor" aria-label="anchor" href="#returns-17"></a></h4>
<p>A <code>data.frame</code> object with observation locations. If <code>longlat = TRUE</code>, the column names are lon and lat, otherwise the column names are x and y.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-observation_to_vertex"></a><div class="section">
<h3 id="method-observation-to-vertex-">Method <code>observation_to_vertex()</code><a class="anchor" aria-label="anchor" href="#method-observation-to-vertex-"></a></h3>
<p>Adds observation locations as vertices in the graph.</p><div class="section">
<h4 id="usage-18">Usage<a class="anchor" aria-label="anchor" href="#usage-18"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">observation_to_vertex</span><span class="op">(</span>tolerance <span class="op">=</span> <span class="fl">1e-15</span>, mesh_warning <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-10">Arguments<a class="anchor" aria-label="anchor" href="#arguments-10"></a></h4>
<p></p><div class="arguments"><dl><dt><code>tolerance</code></dt>
<dd><p>Observations locations are merged to a single vertex if
they are closer than this number (given in relative edge distance between
0 and 1). The default is <code>1e-15</code>.</p></dd>


<dt><code>mesh_warning</code></dt>
<dd><p>Display a warning if the graph structure change and the metric graph has a mesh object.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-18">Returns<a class="anchor" aria-label="anchor" href="#returns-18"></a></h4>
<p>No return value. Called for its side effects.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-get_mesh_locations"></a><div class="section">
<h3 id="method-get-mesh-locations-">Method <code>get_mesh_locations()</code><a class="anchor" aria-label="anchor" href="#method-get-mesh-locations-"></a></h3>
<p>Returns a list or a matrix with the mesh locations.</p><div class="section">
<h4 id="usage-19">Usage<a class="anchor" aria-label="anchor" href="#usage-19"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">get_mesh_locations</span><span class="op">(</span>bru <span class="op">=</span> <span class="cn">FALSE</span>, loc <span class="op">=</span> <span class="cn">NULL</span>, normalized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-11">Arguments<a class="anchor" aria-label="anchor" href="#arguments-11"></a></h4>
<p></p><div class="arguments"><dl><dt><code>bru</code></dt>
<dd><p>Should an 'inlabru'-friendly list be returned?</p></dd>


<dt><code>loc</code></dt>
<dd><p>If <code>bru</code> is set to <code>TRUE</code>, the name of the location variable.
The default name is 'loc'.</p></dd>


<dt><code>normalized</code></dt>
<dd><p>If TRUE, then the distances in <code>distance_on_edge</code> are
assumed to be normalized to (0,1). Default TRUE.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-19">Returns<a class="anchor" aria-label="anchor" href="#returns-19"></a></h4>
<p>A list or a matrix containing the mesh locations.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-clear_observations"></a><div class="section">
<h3 id="method-clear-observations-">Method <code>clear_observations()</code><a class="anchor" aria-label="anchor" href="#method-clear-observations-"></a></h3>
<p>Clear all observations from the <code>metric_graph</code> object.</p><div class="section">
<h4 id="usage-20">Usage<a class="anchor" aria-label="anchor" href="#usage-20"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">clear_observations</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-20">Returns<a class="anchor" aria-label="anchor" href="#returns-20"></a></h4>
<p>No return value. Called for its side effects.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-process_data"></a><div class="section">
<h3 id="method-process-data-">Method <code>process_data()</code><a class="anchor" aria-label="anchor" href="#method-process-data-"></a></h3>
<p>Process data to the metric graph data format.</p><div class="section">
<h4 id="usage-21">Usage<a class="anchor" aria-label="anchor" href="#usage-21"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">process_data</span><span class="op">(</span></span>
<span>  Spoints <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  edge_number <span class="op">=</span> <span class="st">"edge_number"</span>,</span>
<span>  distance_on_edge <span class="op">=</span> <span class="st">"distance_on_edge"</span>,</span>
<span>  coord_x <span class="op">=</span> <span class="st">"coord_x"</span>,</span>
<span>  coord_y <span class="op">=</span> <span class="st">"coord_y"</span>,</span>
<span>  data_coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PtE"</span>, <span class="st">"spatial"</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tibble <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="va">edge_lengths</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-12">Arguments<a class="anchor" aria-label="anchor" href="#arguments-12"></a></h4>
<p></p><div class="arguments"><dl><dt><code>Spoints</code></dt>
<dd><p><code>SpatialPoints</code> or <code>SpatialPointsDataFrame</code> containing the
observations. It may include the coordinates of the observations only, or
the coordinates as well as the observations.</p></dd>


<dt><code>data</code></dt>
<dd><p>A <code>data.frame</code> or named list containing the observations. In
case of groups, the data.frames for the groups should be stacked vertically,
with a column indicating the index of the group. If <code>data</code> is not <code>NULL</code>,
it takes priority over any eventual data in <code>Spoints</code>.</p></dd>


<dt><code>edge_number</code></dt>
<dd><p>Column (or entry on the list) of the <code>data</code> that
contains the edge numbers. If not supplied, the column with name
"edge_number" will be chosen. Will not be used if <code>Spoints</code> is not <code>NULL</code>.</p></dd>


<dt><code>distance_on_edge</code></dt>
<dd><p>Column (or entry on the list) of the <code>data</code> that
contains the edge numbers. If not supplied, the column with name
"distance_on_edge" will be chosen.  Will not be used if <code>Spoints</code> is not
<code>NULL</code>.</p></dd>


<dt><code>coord_x</code></dt>
<dd><p>Column (or entry on the list) of the <code>data</code> that contains
the x coordinate. If not supplied, the column with name "coord_x" will be
chosen. Will not be used if <code>Spoints</code> is not <code>NULL</code> or if <code>data_coords</code> is
<code>PtE</code>.</p></dd>


<dt><code>coord_y</code></dt>
<dd><p>Column (or entry on the list) of the <code>data</code> that contains
the y coordinate. If not supplied, the column with name "coord_x" will be
chosen. Will not be used if <code>Spoints</code> is not <code>NULL</code> or if <code>data_coords</code> is
<code>PtE</code>.</p></dd>


<dt><code>data_coords</code></dt>
<dd><p>To be used only if <code>Spoints</code> is <code>NULL</code>. It decides which
coordinate system to use. If <code>PtE</code>, the user must provide <code>edge_number</code> and
<code>distance_on_edge</code>, otherwise if <code>spatial</code>, the user must provide
<code>coord_x</code> and <code>coord_y</code>. The option <code>euclidean</code> is <a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a>. Use <code>spatial</code> instead.</p></dd>


<dt><code>group</code></dt>
<dd><p>If the data is grouped (for example measured at different time
points), this argument specifies the the column (or entry on the list) in
which the group variable is stored.</p></dd>


<dt><code>normalized</code></dt>
<dd><p>if TRUE, then the distances in <code>distance_on_edge</code> are
assumed to be normalized to (0,1). Default FALSE. Will not be used if
<code>Spoints</code> is not <code>NULL</code>.</p></dd>


<dt><code>tibble</code></dt>
<dd><p>Should the data be returned as a <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tidyr::tibble</a></code>?</p></dd>


<dt><code>tolerance</code></dt>
<dd><p>Parameter to control a warning when adding observations.
If the distance of some location and the closest point on the graph is
greater than the tolerance, the function will display a warning.
This helps detecting mistakes on the input locations when adding new data.</p></dd>


<dt><code>verbose</code></dt>
<dd><p>If <code>TRUE</code>, report steps and times.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-21">Returns<a class="anchor" aria-label="anchor" href="#returns-21"></a></h4>
<p>No return value. Called for its side effects. The observations are
stored in the <code>data</code> element of the <code>metric_graph</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-add_observations"></a><div class="section">
<h3 id="method-add-observations-">Method <code>add_observations()</code><a class="anchor" aria-label="anchor" href="#method-add-observations-"></a></h3>
<p>Add observations to the metric graph.</p><div class="section">
<h4 id="usage-22">Usage<a class="anchor" aria-label="anchor" href="#usage-22"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span></span>
<span>  Spoints <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  edge_number <span class="op">=</span> <span class="st">"edge_number"</span>,</span>
<span>  distance_on_edge <span class="op">=</span> <span class="st">"distance_on_edge"</span>,</span>
<span>  coord_x <span class="op">=</span> <span class="st">"coord_x"</span>,</span>
<span>  coord_y <span class="op">=</span> <span class="st">"coord_y"</span>,</span>
<span>  data_coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PtE"</span>, <span class="st">"spatial"</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  clear_obs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tibble <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="va">edge_lengths</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-13">Arguments<a class="anchor" aria-label="anchor" href="#arguments-13"></a></h4>
<p></p><div class="arguments"><dl><dt><code>Spoints</code></dt>
<dd><p><code>SpatialPoints</code> or <code>SpatialPointsDataFrame</code> containing the
observations. It may include the coordinates of the observations only, or
the coordinates as well as the observations.</p></dd>


<dt><code>data</code></dt>
<dd><p>A <code>data.frame</code> or named list containing the observations. In
case of groups, the data.frames for the groups should be stacked vertically,
with a column indicating the index of the group. If <code>data</code> is not <code>NULL</code>,
it takes priority over any eventual data in <code>Spoints</code>.</p></dd>


<dt><code>edge_number</code></dt>
<dd><p>Column (or entry on the list) of the <code>data</code> that
contains the edge numbers. If not supplied, the column with name
"edge_number" will be chosen. Will not be used if <code>Spoints</code> is not <code>NULL</code>.</p></dd>


<dt><code>distance_on_edge</code></dt>
<dd><p>Column (or entry on the list) of the <code>data</code> that
contains the edge numbers. If not supplied, the column with name
"distance_on_edge" will be chosen.  Will not be used if <code>Spoints</code> is not
<code>NULL</code>.</p></dd>


<dt><code>coord_x</code></dt>
<dd><p>Column (or entry on the list) of the <code>data</code> that contains
the x coordinate. If not supplied, the column with name "coord_x" will be
chosen. Will not be used if <code>Spoints</code> is not <code>NULL</code> or if <code>data_coords</code> is
<code>PtE</code>.</p></dd>


<dt><code>coord_y</code></dt>
<dd><p>Column (or entry on the list) of the <code>data</code> that contains
the y coordinate. If not supplied, the column with name "coord_x" will be
chosen. Will not be used if <code>Spoints</code> is not <code>NULL</code> or if <code>data_coords</code> is
<code>PtE</code>.</p></dd>


<dt><code>data_coords</code></dt>
<dd><p>To be used only if <code>Spoints</code> is <code>NULL</code>. It decides which
coordinate system to use. If <code>PtE</code>, the user must provide <code>edge_number</code> and
<code>distance_on_edge</code>, otherwise if <code>spatial</code>, the user must provide
<code>coord_x</code> and <code>coord_y</code>. The option <code>euclidean</code> is <a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a>. Use <code>spatial</code> instead.</p></dd>


<dt><code>group</code></dt>
<dd><p>If the data is grouped (for example measured at different time
points), this argument specifies the the column (or entry on the list) in
which the group variable is stored.</p></dd>


<dt><code>normalized</code></dt>
<dd><p>if TRUE, then the distances in <code>distance_on_edge</code> are
assumed to be normalized to (0,1). Default FALSE. Will not be used if
<code>Spoints</code> is not <code>NULL</code>.</p></dd>


<dt><code>clear_obs</code></dt>
<dd><p>Should the existing observations be removed before adding the data?</p></dd>


<dt><code>tibble</code></dt>
<dd><p>Should the data be returned as a <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tidyr::tibble</a></code>?</p></dd>


<dt><code>tolerance</code></dt>
<dd><p>Parameter to control a warning when adding observations.
If the distance of some location and the closest point on the graph is
greater than the tolerance, the function will display a warning.
This helps detecting mistakes on the input locations when adding new data.</p></dd>


<dt><code>verbose</code></dt>
<dd><p>If <code>TRUE</code>, report steps and times.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-22">Returns<a class="anchor" aria-label="anchor" href="#returns-22"></a></h4>
<p>No return value. Called for its side effects. The observations are
stored in the <code>data</code> element of the <code>metric_graph</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-mutate"></a><div class="section">
<h3 id="method-mutate-">Method <code><a href="mutate.metric_graph_data.html">mutate()</a></code><a class="anchor" aria-label="anchor" href="#method-mutate-"></a></h3>
<p>Use <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate</a></code> function on the internal metric graph data object.</p><div class="section">
<h4 id="usage-23">Usage<a class="anchor" aria-label="anchor" href="#usage-23"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">mutate</span><span class="op">(</span><span class="va">...</span>, .drop_na <span class="op">=</span> <span class="cn">FALSE</span>, .drop_all_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-14">Arguments<a class="anchor" aria-label="anchor" href="#arguments-14"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Arguments to be passed to <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code>.</p></dd>


<dt><code>.drop_na</code></dt>
<dd><p>Should the rows with at least one NA for one of the columns be removed? DEFAULT is <code>FALSE</code>.</p></dd>


<dt><code>.drop_all_na</code></dt>
<dd><p>Should the rows with all variables being NA be removed? DEFAULT is <code>TRUE</code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-3">Details<a class="anchor" aria-label="anchor" href="#details-3"></a></h4>
<p>A wrapper to use <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> within the internal metric graph data object.</p>
</div>

<div class="section">
<h4 id="returns-23">Returns<a class="anchor" aria-label="anchor" href="#returns-23"></a></h4>
<p>A <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tidyr::tibble</a></code> object containing the resulting data list after the mutate.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-drop_na"></a><div class="section">
<h3 id="method-drop-na-">Method <code><a href="drop_na.metric_graph_data.html">drop_na()</a></code><a class="anchor" aria-label="anchor" href="#method-drop-na-"></a></h3>
<p>Use <code><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">tidyr::drop_na()</a></code> function on the internal metric graph data object.</p><div class="section">
<h4 id="usage-24">Usage<a class="anchor" aria-label="anchor" href="#usage-24"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">drop_na</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-15">Arguments<a class="anchor" aria-label="anchor" href="#arguments-15"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Arguments to be passed to <code><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">tidyr::drop_na()</a></code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-4">Details<a class="anchor" aria-label="anchor" href="#details-4"></a></h4>
<p>A wrapper to use <code>dplyr::drop_na()</code> within the internal metric graph data object.</p>
</div>

<div class="section">
<h4 id="returns-24">Returns<a class="anchor" aria-label="anchor" href="#returns-24"></a></h4>
<p>A <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tidyr::tibble</a></code> object containing the resulting data list after the drop_na.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-select"></a><div class="section">
<h3 id="method-select-">Method <code><a href="select.metric_graph_data.html">select()</a></code><a class="anchor" aria-label="anchor" href="#method-select-"></a></h3>
<p>Use <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select</a></code> function on the internal metric graph data object.</p><div class="section">
<h4 id="usage-25">Usage<a class="anchor" aria-label="anchor" href="#usage-25"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="va">...</span>, .drop_na <span class="op">=</span> <span class="cn">FALSE</span>, .drop_all_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-16">Arguments<a class="anchor" aria-label="anchor" href="#arguments-16"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Arguments to be passed to <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select()</a></code>.</p></dd>


<dt><code>.drop_na</code></dt>
<dd><p>Should the rows with at least one NA for one of the columns be removed? DEFAULT is <code>FALSE</code>.</p></dd>


<dt><code>.drop_all_na</code></dt>
<dd><p>Should the rows with all variables being NA be removed? DEFAULT is <code>TRUE</code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-5">Details<a class="anchor" aria-label="anchor" href="#details-5"></a></h4>
<p>A wrapper to use <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select()</a></code> within the internal metric graph data object. Observe that it is a bit different from directly using <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select()</a></code> since it does not allow to remove the internal positions that are needed for the metric_graph methods to work.</p>
</div>

<div class="section">
<h4 id="returns-25">Returns<a class="anchor" aria-label="anchor" href="#returns-25"></a></h4>
<p>A <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tidyr::tibble</a></code> object containing the resulting data list after the selection.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-filter"></a><div class="section">
<h3 id="method-filter-">Method <code><a href="filter.metric_graph_data.html">filter()</a></code><a class="anchor" aria-label="anchor" href="#method-filter-"></a></h3>
<p>Use <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter</a></code> function on the internal metric graph data object.</p><div class="section">
<h4 id="usage-26">Usage<a class="anchor" aria-label="anchor" href="#usage-26"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">...</span>, .drop_na <span class="op">=</span> <span class="cn">FALSE</span>, .drop_all_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-17">Arguments<a class="anchor" aria-label="anchor" href="#arguments-17"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Arguments to be passed to <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter()</a></code>.</p></dd>


<dt><code>.drop_na</code></dt>
<dd><p>Should the rows with at least one NA for one of the columns be removed? DEFAULT is <code>FALSE</code>.</p></dd>


<dt><code>.drop_all_na</code></dt>
<dd><p>Should the rows with all variables being NA be removed? DEFAULT is <code>TRUE</code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-6">Details<a class="anchor" aria-label="anchor" href="#details-6"></a></h4>
<p>A wrapper to use <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter()</a></code> within the internal metric graph data object.</p>
</div>

<div class="section">
<h4 id="returns-26">Returns<a class="anchor" aria-label="anchor" href="#returns-26"></a></h4>
<p>A <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tidyr::tibble</a></code> object containing the resulting data list after the filter.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-summarise"></a><div class="section">
<h3 id="method-summarise-">Method <code><a href="summarise.metric_graph_data.html">summarise()</a></code><a class="anchor" aria-label="anchor" href="#method-summarise-"></a></h3>
<p>Use <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">dplyr::summarise</a></code> function on the internal metric graph data object grouped by the spatial locations and the internal group variable.</p><div class="section">
<h4 id="usage-27">Usage<a class="anchor" aria-label="anchor" href="#usage-27"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">summarise</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  .include_graph_groups <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  .groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .drop_na <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  .drop_all_na <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-18">Arguments<a class="anchor" aria-label="anchor" href="#arguments-18"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Arguments to be passed to <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">dplyr::summarise()</a></code>.</p></dd>


<dt><code>.include_graph_groups</code></dt>
<dd><p>Should the internal graph groups be included in the grouping variables? The default is <code>FALSE</code>. This means that, when summarising, the data will be grouped by the internal group variable together with the spatial locations.</p></dd>


<dt><code>.groups</code></dt>
<dd><p>A vector of strings containing the names of the columns to be additionally grouped, when computing the summaries. The default is <code>NULL</code>.</p></dd>


<dt><code>.drop_na</code></dt>
<dd><p>Should the rows with at least one NA for one of the columns be removed? DEFAULT is <code>FALSE</code>.</p></dd>


<dt><code>.drop_all_na</code></dt>
<dd><p>Should the rows with all variables being NA be removed? DEFAULT is <code>TRUE</code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-7">Details<a class="anchor" aria-label="anchor" href="#details-7"></a></h4>
<p>A wrapper to use <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">dplyr::summarise()</a></code> within the internal metric graph data object grouped by manually inserted groups (optional), the internal group variable (optional) and the spatial locations. Observe that if the integral group variable was not used as a grouping variable for the summarise, a new column, called <code>.group</code>, will be added, with the same value 1 for all rows.</p>
</div>

<div class="section">
<h4 id="returns-27">Returns<a class="anchor" aria-label="anchor" href="#returns-27"></a></h4>
<p>A <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tidyr::tibble</a></code> object containing the resulting data list after the summarise.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-get_data"></a><div class="section">
<h3 id="method-get-data-">Method <code>get_data()</code><a class="anchor" aria-label="anchor" href="#method-get-data-"></a></h3>
<p>Return the internal data with the option to filter by groups.</p><div class="section">
<h4 id="usage-28">Usage<a class="anchor" aria-label="anchor" href="#usage-28"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span></span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tibble <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  drop_na <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop_all_na <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-19">Arguments<a class="anchor" aria-label="anchor" href="#arguments-19"></a></h4>
<p></p><div class="arguments"><dl><dt><code>group</code></dt>
<dd><p>A vector contaning which groups should be returned? The default is <code>NULL</code>, which gives the result for the all groups.</p></dd>


<dt><code>tibble</code></dt>
<dd><p>Should the data be returned as a <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tidyr::tibble</a></code>?</p></dd>


<dt><code>drop_na</code></dt>
<dd><p>Should the rows with at least one NA for one of the columns be removed? DEFAULT is <code>FALSE</code>.</p></dd>


<dt><code>drop_all_na</code></dt>
<dd><p>Should the rows with all variables being NA be removed? DEFAULT is <code>TRUE</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-metric_graph-buildC"></a><div class="section">
<h3 id="method-buildc-">Method <code>buildC()</code><a class="anchor" aria-label="anchor" href="#method-buildc-"></a></h3>
<p>Build Kirchoff constraint matrix from edges.</p><div class="section">
<h4 id="usage-29">Usage<a class="anchor" aria-label="anchor" href="#usage-29"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">buildC</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">2</span>, edge_constraint <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-20">Arguments<a class="anchor" aria-label="anchor" href="#arguments-20"></a></h4>
<p></p><div class="arguments"><dl><dt><code>alpha</code></dt>
<dd><p>the type of constraint (currently only supports 2)</p></dd>


<dt><code>edge_constraint</code></dt>
<dd><p>if TRUE, add constraints on vertices of degree 1</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-8">Details<a class="anchor" aria-label="anchor" href="#details-8"></a></h4>
<p>Currently not implemented for circles (edges that start and end
in the same vertex)</p>
</div>

<div class="section">
<h4 id="returns-28">Returns<a class="anchor" aria-label="anchor" href="#returns-28"></a></h4>
<p>No return value. Called for its side effects.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-build_mesh"></a><div class="section">
<h3 id="method-build-mesh-">Method <code>build_mesh()</code><a class="anchor" aria-label="anchor" href="#method-build-mesh-"></a></h3>
<p>Builds mesh object for graph.</p><div class="section">
<h4 id="usage-30">Usage<a class="anchor" aria-label="anchor" href="#usage-30"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">build_mesh</span><span class="op">(</span>h <span class="op">=</span> <span class="cn">NULL</span>, n <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-21">Arguments<a class="anchor" aria-label="anchor" href="#arguments-21"></a></h4>
<p></p><div class="arguments"><dl><dt><code>h</code></dt>
<dd><p>Maximum distance between mesh nodes (should be provided if n is
not provided).</p></dd>


<dt><code>n</code></dt>
<dd><p>Maximum number of nodes per edge (should be provided if h is not
provided).</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-9">Details<a class="anchor" aria-label="anchor" href="#details-9"></a></h4>
<p>The mesh is a list with the objects:</p><ul><li><p><code>PtE</code> The mesh locations excluding the original vertices;</p></li>
<li><p><code>V</code> The verties of the mesh;</p></li>
<li><p><code>E</code> The edges of the mesh;</p></li>
<li><p><code>n_e</code> The number of vertices in the mesh per original edge in the graph;</p></li>
<li><p><code>h_e</code> The mesh width per edge in the graph;</p></li>
<li><p><code>ind</code> The indices of the vertices in the mesh;</p></li>
<li><p><code>VtE</code> All mesh locations including the original vertices.</p></li>
</ul></div>

<div class="section">
<h4 id="returns-29">Returns<a class="anchor" aria-label="anchor" href="#returns-29"></a></h4>
<p>No return value. Called for its side effects. The mesh is stored in
the <code>mesh</code> element of the <code>metric_graph</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-compute_fem"></a><div class="section">
<h3 id="method-compute-fem-">Method <code>compute_fem()</code><a class="anchor" aria-label="anchor" href="#method-compute-fem-"></a></h3>
<p>Build mass and stiffness matrices for given mesh object.</p><div class="section">
<h4 id="usage-31">Usage<a class="anchor" aria-label="anchor" href="#usage-31"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">compute_fem</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="details-10">Details<a class="anchor" aria-label="anchor" href="#details-10"></a></h4>
<p>The function builds: The matrix <code>C</code> which is the mass matrix with
elements \(C_{ij} = &lt;\phi_i, \phi_j&gt;\), the matrix <code>G</code> which is the stiffness
matrix with elements \(G_{ij} = &lt;d\phi_i, d\phi_j&gt;\), the matrix <code>B</code> with
elements \(B_{ij} = &lt;d\phi_i, \phi_j&gt;\), the matrix <code>D</code> with elements
\(D_{ij} = \sum_{v\in V}\phi_i(v)\phi_j(v)\), and the vector with weights
\(&lt;\phi_i, 1&gt;\).</p>
</div>

<div class="section">
<h4 id="returns-30">Returns<a class="anchor" aria-label="anchor" href="#returns-30"></a></h4>
<p>No return value. Called for its side effects. The finite element
matrices <code>C</code>, <code>G</code> and <code>B</code> are stored in the <code>mesh</code> element in the
<code>metric_graph</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-mesh_A"></a><div class="section">
<h3 id="method-mesh-a-">Method <code>mesh_A()</code><a class="anchor" aria-label="anchor" href="#method-mesh-a-"></a></h3>
<p>Deprecated - Computes observation matrix for mesh.</p>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> in favour of <code>metric_graph$fem_basis()</code>.</p><div class="section">
<h4 id="usage-32">Usage<a class="anchor" aria-label="anchor" href="#usage-32"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">mesh_A</span><span class="op">(</span><span class="va">PtE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-22">Arguments<a class="anchor" aria-label="anchor" href="#arguments-22"></a></h4>
<p></p><div class="arguments"><dl><dt><code>PtE</code></dt>
<dd><p>Locations given as (edge number in graph, normalized location on
edge)</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-11">Details<a class="anchor" aria-label="anchor" href="#details-11"></a></h4>
<p>For n locations and a mesh with m nodes, <code>A</code> is an n x m matrix with
elements \(A_{ij} = \phi_j(s_i)\).</p>
</div>

<div class="section">
<h4 id="returns-31">Returns<a class="anchor" aria-label="anchor" href="#returns-31"></a></h4>
<p>The observation matrix.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-fem_basis"></a><div class="section">
<h3 id="method-fem-basis-">Method <code>fem_basis()</code><a class="anchor" aria-label="anchor" href="#method-fem-basis-"></a></h3>
<p>Computes observation matrix for mesh.</p><div class="section">
<h4 id="usage-33">Usage<a class="anchor" aria-label="anchor" href="#usage-33"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">fem_basis</span><span class="op">(</span><span class="va">PtE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-23">Arguments<a class="anchor" aria-label="anchor" href="#arguments-23"></a></h4>
<p></p><div class="arguments"><dl><dt><code>PtE</code></dt>
<dd><p>Locations given as (edge number in graph, normalized location on
edge)</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-12">Details<a class="anchor" aria-label="anchor" href="#details-12"></a></h4>
<p>For n locations and a mesh with m nodes, <code>A</code> is an n x m matrix with
elements \(A_{ij} = \phi_j(s_i)\).</p>
</div>

<div class="section">
<h4 id="returns-32">Returns<a class="anchor" aria-label="anchor" href="#returns-32"></a></h4>
<p>The observation matrix.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-VtEfirst"></a><div class="section">
<h3 id="method-vtefirst-">Method <code>VtEfirst()</code><a class="anchor" aria-label="anchor" href="#method-vtefirst-"></a></h3>
<p>Find one edge corresponding to each vertex.</p><div class="section">
<h4 id="usage-34">Usage<a class="anchor" aria-label="anchor" href="#usage-34"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">VtEfirst</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-33">Returns<a class="anchor" aria-label="anchor" href="#returns-33"></a></h4>
<p>A nV x 2 matrix the first element of the <code>i</code>th row is the edge
number corresponding to the <code>i</code>th vertex and the second value is 0
if the vertex is at the start of the edge and 1 if the vertex
is at the end of the edge.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-plot"></a><div class="section">
<h3 id="method-plot-">Method <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code><a class="anchor" aria-label="anchor" href="#method-plot-"></a></h3>
<p>Plots the metric graph.</p><div class="section">
<h4 id="usage-35">Usage<a class="anchor" aria-label="anchor" href="#usage-35"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  plotly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  vertex_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  vertex_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  edge_width <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  edge_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  data_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  support_width <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  support_color <span class="op">=</span> <span class="st">"gray"</span>,</span>
<span>  mesh <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  X <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  X_loc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  degree <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  direction <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-24">Arguments<a class="anchor" aria-label="anchor" href="#arguments-24"></a></h4>
<p></p><div class="arguments"><dl><dt><code>data</code></dt>
<dd><p>Which column of the data to plot? If <code>NULL</code>, no data will be
plotted.</p></dd>


<dt><code>newdata</code></dt>
<dd><p>A dataset of class <code>metric_graph_data</code>, obtained by any <code>get_data()</code>, <code><a href="mutate.metric_graph_data.html">mutate()</a></code>, <code><a href="filter.metric_graph_data.html">filter()</a></code>, <code><a href="summarise.metric_graph_data.html">summarise()</a></code>, <code><a href="drop_na.metric_graph_data.html">drop_na()</a></code> methods of metric graphs, see the vignette on data manipulation for more details.</p></dd>


<dt><code>group</code></dt>
<dd><p>If there are groups, which group to plot? If <code>group</code> is a
number, it will be the index of the group as stored internally. If <code>group</code>
is a character, then the group will be chosen by its name.</p></dd>


<dt><code>plotly</code></dt>
<dd><p>Use plot_ly for 3D plot (default <code>FALSE</code>). This option
requires the 'plotly' package.</p></dd>


<dt><code>vertex_size</code></dt>
<dd><p>Size of the vertices.</p></dd>


<dt><code>vertex_color</code></dt>
<dd><p>Color of vertices.</p></dd>


<dt><code>edge_width</code></dt>
<dd><p>Line width for edges.</p></dd>


<dt><code>edge_color</code></dt>
<dd><p>Color of edges.</p></dd>


<dt><code>data_size</code></dt>
<dd><p>Size of markers for data.</p></dd>


<dt><code>support_width</code></dt>
<dd><p>For 3D plot, width of support lines.</p></dd>


<dt><code>support_color</code></dt>
<dd><p>For 3D plot, color of support lines.</p></dd>


<dt><code>mesh</code></dt>
<dd><p>Plot the mesh locations?</p></dd>


<dt><code>X</code></dt>
<dd><p>Additional values to plot.</p></dd>


<dt><code>X_loc</code></dt>
<dd><p>Locations of the additional values in the format
(edge, normalized distance on edge).</p></dd>


<dt><code>p</code></dt>
<dd><p>Existing objects obtained from 'ggplot2' or 'plotly' to add the graph to</p></dd>


<dt><code>degree</code></dt>
<dd><p>Show the degrees of the vertices?</p></dd>


<dt><code>direction</code></dt>
<dd><p>Show the direction of the edges?</p></dd>


<dt><code>...</code></dt>
<dd><p>Additional arguments to pass to <code>ggplot()</code> or <code>plot_ly()</code></p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-34">Returns<a class="anchor" aria-label="anchor" href="#returns-34"></a></h4>
<p>A <code>plot_ly</code> (if <code>plotly = TRUE</code>) or <code>ggplot</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-plot_connections"></a><div class="section">
<h3 id="method-plot-connections-">Method <code>plot_connections()</code><a class="anchor" aria-label="anchor" href="#method-plot-connections-"></a></h3>
<p>Plots the connections in the graph</p><div class="section">
<h4 id="usage-36">Usage<a class="anchor" aria-label="anchor" href="#usage-36"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">plot_connections</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-35">Returns<a class="anchor" aria-label="anchor" href="#returns-35"></a></h4>
<p>No return value. Called for its side effects.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-is_tree"></a><div class="section">
<h3 id="method-is-tree-">Method <code>is_tree()</code><a class="anchor" aria-label="anchor" href="#method-is-tree-"></a></h3>
<p>Checks if the graph is a tree (without considering directions)</p><div class="section">
<h4 id="usage-37">Usage<a class="anchor" aria-label="anchor" href="#usage-37"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">is_tree</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-36">Returns<a class="anchor" aria-label="anchor" href="#returns-36"></a></h4>
<p>TRUE if the graph is a tree and FALSE otherwise.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-plot_function"></a><div class="section">
<h3 id="method-plot-function-">Method <code>plot_function()</code><a class="anchor" aria-label="anchor" href="#method-plot-function-"></a></h3>
<p>Plots continuous function on the graph.</p><div class="section">
<h4 id="usage-38">Usage<a class="anchor" aria-label="anchor" href="#usage-38"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">plot_function</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  X <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plotly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  vertex_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  vertex_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  edge_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  edge_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  line_width <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  line_color <span class="op">=</span> <span class="st">"rgb(0,0,200)"</span>,</span>
<span>  support_width <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  support_color <span class="op">=</span> <span class="st">"gray"</span>,</span>
<span>  p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-25">Arguments<a class="anchor" aria-label="anchor" href="#arguments-25"></a></h4>
<p></p><div class="arguments"><dl><dt><code>data</code></dt>
<dd><p>Which column of the data to plot? If <code>NULL</code>, no data will be
plotted.</p></dd>


<dt><code>newdata</code></dt>
<dd><p>A dataset of class <code>metric_graph_data</code>, obtained by any <code>get_data()</code>, <code><a href="mutate.metric_graph_data.html">mutate()</a></code>, <code><a href="filter.metric_graph_data.html">filter()</a></code>, <code><a href="summarise.metric_graph_data.html">summarise()</a></code>, <code><a href="drop_na.metric_graph_data.html">drop_na()</a></code> methods of metric graphs, see the vignette on data manipulation for more details.</p></dd>


<dt><code>group</code></dt>
<dd><p>If there are groups, which group to plot? If <code>group</code> is a
number, it will be the index of the group as stored internally. If <code>group</code>
is a character, then the group will be chosen by its name.</p></dd>


<dt><code>X</code></dt>
<dd><p>A vector with values for the function
evaluated at the mesh in the graph</p></dd>


<dt><code>plotly</code></dt>
<dd><p>If <code>TRUE</code>, then the plot is shown in 3D. This option requires
the package 'plotly'.</p></dd>


<dt><code>vertex_size</code></dt>
<dd><p>Size of the vertices.</p></dd>


<dt><code>vertex_color</code></dt>
<dd><p>Color of vertices.</p></dd>


<dt><code>edge_width</code></dt>
<dd><p>Width for edges.</p></dd>


<dt><code>edge_color</code></dt>
<dd><p>For 3D plot, color of edges.</p></dd>


<dt><code>line_width</code></dt>
<dd><p>For 3D plot, line width of the function curve.</p></dd>


<dt><code>line_color</code></dt>
<dd><p>Color of the function curve.</p></dd>


<dt><code>support_width</code></dt>
<dd><p>For 3D plot, width of support lines.</p></dd>


<dt><code>support_color</code></dt>
<dd><p>For 3D plot, color of support lines.</p></dd>


<dt><code>p</code></dt>
<dd><p>Previous plot to which the new plot should be added.</p></dd>


<dt><code>...</code></dt>
<dd><p>Additional arguments for <code>ggplot()</code> or <code>plot_ly()</code></p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-37">Returns<a class="anchor" aria-label="anchor" href="#returns-37"></a></h4>
<p>Either a <code>ggplot</code> (if <code>plotly = FALSE</code>) or a <code>plot_ly</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-plot_movie"></a><div class="section">
<h3 id="method-plot-movie-">Method <code>plot_movie()</code><a class="anchor" aria-label="anchor" href="#method-plot-movie-"></a></h3>
<p>Plots a movie of a continuous function evolving on the graph.</p><div class="section">
<h4 id="usage-39">Usage<a class="anchor" aria-label="anchor" href="#usage-39"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">plot_movie</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  plotly <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  vertex_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  vertex_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  edge_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  edge_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  line_width <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  line_color <span class="op">=</span> <span class="st">"rgb(0,0,200)"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-26">Arguments<a class="anchor" aria-label="anchor" href="#arguments-26"></a></h4>
<p></p><div class="arguments"><dl><dt><code>X</code></dt>
<dd><p>A m x T matrix where the ith column represents the function at the
ith time, evaluated at the mesh locations.</p></dd>


<dt><code>plotly</code></dt>
<dd><p>If <code>TRUE</code>, then plot is shown in 3D. This option requires the
package 'plotly'.</p></dd>


<dt><code>vertex_size</code></dt>
<dd><p>Size of the vertices.</p></dd>


<dt><code>vertex_color</code></dt>
<dd><p>Color of vertices.</p></dd>


<dt><code>edge_width</code></dt>
<dd><p>Width for edges.</p></dd>


<dt><code>edge_color</code></dt>
<dd><p>For 3D plot, color of edges.</p></dd>


<dt><code>line_width</code></dt>
<dd><p>For 3D plot, line width of the function curve.</p></dd>


<dt><code>line_color</code></dt>
<dd><p>Color of the function curve.</p></dd>


<dt><code>...</code></dt>
<dd><p>Additional arguments for ggplot or plot_ly.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-38">Returns<a class="anchor" aria-label="anchor" href="#returns-38"></a></h4>
<p>Either a <code>ggplot</code> (if <code>plotly=FALSE</code>) or a <code>plot_ly</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-add_mesh_observations"></a><div class="section">
<h3 id="method-add-mesh-observations-">Method <code>add_mesh_observations()</code><a class="anchor" aria-label="anchor" href="#method-add-mesh-observations-"></a></h3>
<p>Add observations on mesh to the object.</p><div class="section">
<h4 id="usage-40">Usage<a class="anchor" aria-label="anchor" href="#usage-40"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">add_mesh_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NULL</span>, group <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-27">Arguments<a class="anchor" aria-label="anchor" href="#arguments-27"></a></h4>
<p></p><div class="arguments"><dl><dt><code>data</code></dt>
<dd><p>A <code>data.frame</code> or named list containing the observations.
In case of groups, the data.frames for the groups should be stacked vertically,
with a column indicating the index of the group. If <code>data_frame</code> is not
<code>NULL</code>, it takes priority over any eventual data in <code>Spoints</code>.</p></dd>


<dt><code>group</code></dt>
<dd><p>If the data_frame contains groups, one must provide the column
in which the group indices are stored.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-39">Returns<a class="anchor" aria-label="anchor" href="#returns-39"></a></h4>
<p>No return value. Called for its side effects. The observations are
stored in the <code>data</code> element in the <code>metric_graph</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-get_initial_graph"></a><div class="section">
<h3 id="method-get-initial-graph-">Method <code>get_initial_graph()</code><a class="anchor" aria-label="anchor" href="#method-get-initial-graph-"></a></h3>
<p>Returns a copy of the initial metric graph.</p><div class="section">
<h4 id="usage-41">Usage<a class="anchor" aria-label="anchor" href="#usage-41"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">get_initial_graph</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-40">Returns<a class="anchor" aria-label="anchor" href="#returns-40"></a></h4>
<p>A <code>metric_graph</code> object.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-coordinates"></a><div class="section">
<h3 id="method-coordinates-">Method <code><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates()</a></code><a class="anchor" aria-label="anchor" href="#method-coordinates-"></a></h3>
<p>Convert between locations on the graph and Euclidean
coordinates.</p><div class="section">
<h4 id="usage-42">Usage<a class="anchor" aria-label="anchor" href="#usage-42"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">coordinates</span><span class="op">(</span>PtE <span class="op">=</span> <span class="cn">NULL</span>, XY <span class="op">=</span> <span class="cn">NULL</span>, normalized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-28">Arguments<a class="anchor" aria-label="anchor" href="#arguments-28"></a></h4>
<p></p><div class="arguments"><dl><dt><code>PtE</code></dt>
<dd><p>Matrix with locations on the graph (edge number and normalized
position on the edge).</p></dd>


<dt><code>XY</code></dt>
<dd><p>Matrix with locations in Euclidean space</p></dd>


<dt><code>normalized</code></dt>
<dd><p>If <code>TRUE</code>, it is assumed that the positions in <code>PtE</code> are
normalized to (0,1), and the object returned if <code>XY</code> is specified contains
normalized locations.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-41">Returns<a class="anchor" aria-label="anchor" href="#returns-41"></a></h4>
<p>If <code>PtE</code> is specified, then a matrix with Euclidean coordinates of
the locations is returned. If <code>XY</code> is provided, then a matrix with the
closest locations on the graph is returned.
data List containing data on the metric graph.</p>
</div>

</div><p></p><hr><a id="method-metric_graph-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-43">Usage<a class="anchor" aria-label="anchor" href="#usage-43"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">metric_graph</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-29">Arguments<a class="anchor" aria-label="anchor" href="#arguments-29"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">edge1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">edge2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">edge3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">edge1</span>, <span class="va">edge2</span>, <span class="va">edge3</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="va">metric_graph</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">edges</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">graph</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="metric_graph-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by David Bolin, Alexandre Simas, Jonas Wallin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

