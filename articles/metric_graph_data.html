<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data manipulation on metric graphs • MetricGraph</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data manipulation on metric graphs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MetricGraph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/MetricGraph.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/metric_graph.html">Working with metric graphs</a></li>
    <li><a class="dropdown-item" href="../articles/random_fields.html">Gaussian random fields on metric graphs</a></li>
    <li><a class="dropdown-item" href="../articles/metric_graph_data.html">Data manipulation on metric graphs</a></li>
    <li><a class="dropdown-item" href="../articles/inlabru_interface.html">inlabru interface of Whittle--Matérn fields</a></li>
    <li><a class="dropdown-item" href="../articles/inla_interface.html">INLA interface of Whittle--Matérn fields</a></li>
    <li><a class="dropdown-item" href="../articles/fem_models.html">Whittle--Matérn fields with general smoothness</a></li>
    <li><a class="dropdown-item" href="../articles/pointprocess.html">Log-Gaussian Cox processes on metric graphs</a></li>
    <li><a class="dropdown-item" href="../articles/comparison.html">Comparison of different models using real data</a></li>
    <li><a class="dropdown-item" href="../articles/isotropic_noneuclidean.html">On isotropic covariances on metric graphs with non-Euclidean edges</a></li>
    <li><a class="dropdown-item" href="../articles/multi_likelihood.html">An example with multiple likelihoods in INLA and inlabru</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/davidbolin/MetricGraph/discussions"><span class="fa fa-comments-o"></span> Discussions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/davidbolin/MetricGraph/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/jdavidbolin" aria-label="Twitter"><span class="fa fa-twitter"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Data manipulation on metric graphs</h1>
                        <h4 data-toc-skip class="author">David Bolin,
Alexandre B. Simas, and Jonas Wallin</h4>
            
            <h4 data-toc-skip class="date">Created: 2023-10-24. Last
modified: 2024-07-19.</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/davidbolin/MetricGraph/blob/devel/vignettes/metric_graph_data.Rmd" class="external-link"><code>vignettes/metric_graph_data.Rmd</code></a></small>
      <div class="d-none name"><code>metric_graph_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette we will provide some examples of data manipulation
on metric graphs. More precisely, we will show how to add data to the
metric graph, how to retrieve the data, how to do data manipulation
using some of the <code>tidyverse</code> tools. Finally, we will show
how add the results of these manipulations back to the metric graph.</p>
<p>As an example throughout the vignette, we consider the following
metric graph:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">edge1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">edge2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">edge3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="va">pi</span>,to<span class="op">=</span><span class="fl">3</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">2</span>,length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">edge4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>,<span class="fl">1</span><span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">edges</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">edge1</span>, <span class="va">edge2</span>, <span class="va">edge3</span>, <span class="va">edge4</span><span class="op">)</span></span>
<span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/metric_graph.html">metric_graph</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>edges <span class="op">=</span> <span class="va">edges</span><span class="op">)</span></span>
<span><span class="va">graph</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="metric_graph_data_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>For further details on the construction of metric graphs, see <a href="metric_graphs.html">Working with metric graphs</a></p>
</div>
<div class="section level2">
<h2 id="adding-and-accessing-data-on-metric-graphs">Adding and accessing data on metric graphs<a class="anchor" aria-label="anchor" href="#adding-and-accessing-data-on-metric-graphs"></a>
</h2>
<p>Let us start by generating some data to be added to the metric graph
object we created, namely <code>graph</code>. We first generate the
locations:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obs_per_edge</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">obs_loc</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">nE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">obs_loc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">obs_loc</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">i</span>,<span class="va">obs_per_edge</span><span class="op">)</span>, </span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">obs_per_edge</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now, we will generate the data and build a <code>data.frame</code> to
be added to the metric graph:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">nE</span> <span class="op">*</span> <span class="va">obs_per_edge</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>, edge <span class="op">=</span> <span class="va">obs_loc</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, pos <span class="op">=</span> <span class="va">obs_loc</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>We can now add the data to the graph by using the
<code>add_mesh_observations()</code> method. We will add the data by
providing the edge number and relative distance on the edge. To this
end, when adding the data, we need to supply the names of the columns
that contain the edge number and the distance on edge by entering the
<code>edge_number</code> and <code>distance_on_edge</code> arguments.
Further, since we are providing the relative distance, we need to set
the <code>normalized</code> argument to <code>TRUE</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_data</span>, edge_number <span class="op">=</span> <span class="st">"edge"</span>, </span>
<span>                    distance_on_edge <span class="op">=</span> <span class="st">"pos"</span>, normalized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Adding observations...</span></span></code></pre>
<p>We can check that the data was successfully added by retrieving them
from the metric graph using the <code>get_data()</code> method:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 6</span></span></span>
<span><span class="co">##          y .edge_number .distance_on_edge .group .coord_x .coord_y</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">0.073</span><span style="color: #BB0000; text-decoration: underline;">6</span>            1            0.013<span style="text-decoration: underline;">4</span>      1   0.013<span style="text-decoration: underline;">4</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  2.09              1            0.023<span style="text-decoration: underline;">3</span>      1   0.023<span style="text-decoration: underline;">3</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  1.68              1            0.061<span style="text-decoration: underline;">8</span>      1   0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.528</span>             1            0.108       1   0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.180</span>             1            0.126       1   0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.462</span>             1            0.177       1   0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">1.52</span>              1            0.186       1   0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.655</span>             1            0.202       1   0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.636</span>             1            0.206       1   0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  1.34              1            0.212       1   0.212         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 190 more rows</span></span></span></code></pre>
<p>We can also visualize the data by using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
method and specifying which column we would like to plot:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>data <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span></code></pre></div>
<p><img src="metric_graph_data_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>We can add more data to the metric graph by using the
<code>add_observations()</code> method again. To this end, let us create
an additional dataset. This time, we will add it using spatial
coordinates. In this case, we will generate <code>50</code> uniform
locations to be the <code>x</code> coordinate of the data, and we will
keep the <code>y</code> coordinate equal to zero. Further, we will
generate <code>50</code> more realizations of a standard gaussian
variable as the <code>y2</code> variable.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coordx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">coordy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y2 <span class="op">=</span> <span class="va">y2</span>, coordx <span class="op">=</span> <span class="va">coordx</span>, coordy <span class="op">=</span> <span class="va">coordy</span><span class="op">)</span></span></code></pre></div>
<p>Let us add this dataset. Now, we need to set <code>data_coords</code>
to <code>"spatial"</code> and we need to supply the names of the columns
of the <code>x</code> and <code>y</code> coordinates:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_data2</span>, data_coords <span class="op">=</span> <span class="st">"spatial"</span>, </span>
<span>                            coord_x <span class="op">=</span> <span class="st">"coordx"</span>, coord_y <span class="op">=</span> <span class="st">"coordy"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Adding observations...</span></span></code></pre>
<pre><code><span><span class="co">## Converting data to PtE</span></span></code></pre>
<pre><code><span><span class="co">## [1] y2     coordx coordy</span></span>
<span><span class="co">## &lt;0 rows&gt; (or 0-length row.names)</span></span></code></pre>
<p>Let us check that the data was successfully added:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 250 × 8</span></span></span>
<span><span class="co">##          y     y2 .distance_to_graph .edge_number .distance_on_edge .group</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">0.073</span><span style="color: #BB0000; text-decoration: underline;">6</span> <span style="color: #BB0000;">NA</span>                     <span style="color: #BB0000;">NA</span>            1            0.013<span style="text-decoration: underline;">4</span>      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  2.09   <span style="color: #BB0000;">NA</span>                     <span style="color: #BB0000;">NA</span>            1            0.023<span style="text-decoration: underline;">3</span>      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> <span style="color: #BB0000;">NA</span>       0.278                  0            1            0.030<span style="text-decoration: underline;">8</span>      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">2.26</span>                   0            1            0.057<span style="text-decoration: underline;">4</span>      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  1.68   <span style="color: #BB0000;">NA</span>                     <span style="color: #BB0000;">NA</span>            1            0.061<span style="text-decoration: underline;">8</span>      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">0.636</span>                  0            1            0.064<span style="text-decoration: underline;">9</span>      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> <span style="color: #BB0000;">NA</span>       1.31                   0            1            0.097<span style="text-decoration: underline;">8</span>      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> <span style="color: #BB0000;">NA</span>      -<span style="color: #BB0000;">0.334</span>                  0            1            0.107       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.528</span>  <span style="color: #BB0000;">NA</span>                     <span style="color: #BB0000;">NA</span>            1            0.108       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.180</span>  <span style="color: #BB0000;">NA</span>                     <span style="color: #BB0000;">NA</span>            1            0.126       1</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 240 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 2 more variables: .coord_x &lt;dbl&gt;, .coord_y &lt;dbl&gt;</span></span></span></code></pre>
<p>We can also plot:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>data <span class="op">=</span> <span class="st">"y2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="metric_graph_data_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Observe that <code>NAs</code> were added, since <code>df_data</code>
does not contain the column <code>y2</code> and <code>df_data2</code>
does not contain the column <code>y</code>.</p>
<p>By default, the <code>get_data()</code> method excludes all rows in
which all the variables are <code>NA</code> (the location variables are
not considered here). We can also show the rows that do not contain any
<code>NA</code> observations by using the <code>drop_na</code> argument
in the <code>get_data()</code> method:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span>drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 0 × 8</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 8 variables: y &lt;dbl&gt;, y2 &lt;dbl&gt;, .distance_to_graph &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   .edge_number &lt;dbl&gt;, .distance_on_edge &lt;dbl&gt;, .group &lt;dbl&gt;, .coord_x &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   .coord_y &lt;dbl&gt;</span></span></span></code></pre>
<p>Observe that there is no row, since all of them contain at least one
<code>NA</code>.</p>
<p>Suppose now that we want to replace the metric graph data by a new
dataset. To this end we have two options. The first one is to use the
<code>clear_observations()</code> method, then add the observations:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">clear_observations</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>We will now create the dataset we want to add. To simplify, we will
use the default naming for the edge number and distance on edge, so that
we do not need to specify them in the <code>add_observations()</code>
method:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">nE</span> <span class="op">*</span> <span class="va">obs_per_edge</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_data3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y3<span class="op">=</span><span class="va">y3</span>, edge_number <span class="op">=</span> <span class="va">obs_loc</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, distance_on_edge <span class="op">=</span> <span class="va">obs_loc</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>We can now add the data. Remember to set <code>normalized</code> to
<code>TRUE</code> since we are providing the relative distance on
edge:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_data3</span>, normalized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Adding observations...</span></span></code></pre>
<p>and check:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 6</span></span></span>
<span><span class="co">##         y3 .edge_number .distance_on_edge .group .coord_x .coord_y</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  1.90              1            0.013<span style="text-decoration: underline;">4</span>      1   0.013<span style="text-decoration: underline;">4</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.710</span>             1            0.023<span style="text-decoration: underline;">3</span>      1   0.023<span style="text-decoration: underline;">3</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  1.15              1            0.061<span style="text-decoration: underline;">8</span>      1   0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>  1.12              1            0.108       1   0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.715</span>             1            0.126       1   0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">2.13</span>              1            0.177       1   0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  1.44              1            0.186       1   0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  1.76              1            0.202       1   0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.056</span><span style="color: #BB0000; text-decoration: underline;">5</span>            1            0.206       1   0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  1.59              1            0.212       1   0.212         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 190 more rows</span></span></span></code></pre>
<p>The second way to replace the data in the metric graph is to set the
<code>clear_obs</code> argument to <code>TRUE</code>. We will also
create a new dataset using the default naming for the <code>x</code> and
<code>y</code> coordinates, so we do not need to specify them:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_data4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">y2</span><span class="op">)</span>, coord_x <span class="op">=</span> <span class="va">coordx</span>, coord_y <span class="op">=</span> <span class="va">coordy</span><span class="op">)</span></span></code></pre></div>
<p>and we add them (remember to set <code>data_coords</code> to
<code>"spatial"</code>):</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_data4</span>, clear_obs <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                            data_coords <span class="op">=</span> <span class="st">"spatial"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Adding observations...</span></span></code></pre>
<pre><code><span><span class="co">## Converting data to PtE</span></span></code></pre>
<pre><code><span><span class="co">## [1] y4      coord_x coord_y</span></span>
<span><span class="co">## &lt;0 rows&gt; (or 0-length row.names)</span></span></code></pre>
<p>and we can check it replaced:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 50 × 7</span></span></span>
<span><span class="co">##       y4 .distance_to_graph .edge_number .distance_on_edge .group .coord_x</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 1.32                   0            1            0.030<span style="text-decoration: underline;">8</span>      1   0.030<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 0.104                  0            1            0.057<span style="text-decoration: underline;">4</span>      1   0.057<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 0.530                  0            1            0.064<span style="text-decoration: underline;">9</span>      1   0.064<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 3.72                   0            1            0.097<span style="text-decoration: underline;">8</span>      1   0.097<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 0.716                  0            1            0.107       1   0.107 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 2.23                   0            1            0.136       1   0.136 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 1.19                   0            1            0.147       1   0.147 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 0.345                  0            1            0.153       1   0.153 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 0.564                  0            1            0.202       1   0.202 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 2.50                   0            1            0.213       1   0.213 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 40 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: .coord_y &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="adding-grouped-data-to-metric-graphs">Adding grouped data to metric graphs<a class="anchor" aria-label="anchor" href="#adding-grouped-data-to-metric-graphs"></a>
</h2>
<p>The graph structure also allow to add grouped data. To this end we
need to specify which column of the data will be the grouping
variable.</p>
<p>To illustrate, let us generate a grouped data. We will use the same
locations we generated in the previous section.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n.repl</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="va">y_repl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n.repl</span> <span class="op">*</span> <span class="va">graph</span><span class="op">$</span><span class="va">nE</span> <span class="op">*</span> <span class="va">obs_per_edge</span><span class="op">)</span></span>
<span><span class="va">repl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n.repl</span>, each <span class="op">=</span> <span class="va">graph</span><span class="op">$</span><span class="va">nE</span> <span class="op">*</span> <span class="va">obs_per_edge</span><span class="op">)</span></span></code></pre></div>
<p>Let us now create the <code>data.frame</code> with the grouped data,
where the grouping variable is <code>repl</code>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_data_repl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y_repl</span>, repl <span class="op">=</span> <span class="va">repl</span>, </span>
<span>                  edge_number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">obs_loc</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, times <span class="op">=</span> <span class="va">n.repl</span><span class="op">)</span>, </span>
<span>                  distance_on_edge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">obs_loc</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, times <span class="op">=</span> <span class="va">n.repl</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can now add this <code>data.frame</code> to the graph by using the
<code>add_observations()</code> method. We need to set
<code>normalized</code> to <code>TRUE</code>, since we have relative
distances on edge. We also need to set the <code>group</code> argument
to <code>repl</code>, since <code>repl</code> is our grouping variable.
Finally, we will also set <code>clear_obs</code> to <code>TRUE</code>
since we want to replace the existing data.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_data_repl</span>, </span>
<span>                        normalized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                        clear_obs <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                        group <span class="op">=</span> <span class="st">"repl"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Adding observations...</span></span></code></pre>
<p>Let us check the graph data. Observe that the grouping variable is
now <code>.group</code>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1,000 × 7</span></span></span>
<span><span class="co">##         y  repl .edge_number .distance_on_edge .group .coord_x .coord_y</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  1.50      1            1            0.013<span style="text-decoration: underline;">4</span> 1        0.013<span style="text-decoration: underline;">4</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">1.79</span>      1            1            0.023<span style="text-decoration: underline;">3</span> 1        0.023<span style="text-decoration: underline;">3</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  0.488     1            1            0.061<span style="text-decoration: underline;">8</span> 1        0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.385</span>     1            1            0.108  1        0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  0.905     1            1            0.126  1        0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.145</span>     1            1            0.177  1        0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  2.00      1            1            0.186  1        0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">1.16</span>      1            1            0.202  1        0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  0.879     1            1            0.206  1        0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.816</span>     1            1            0.212  1        0.212         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 990 more rows</span></span></span></code></pre>
<p>We can obtain the data for a given group by setting the
<code>group</code> argument in the <code>get_data()</code> method:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span>group <span class="op">=</span> <span class="st">"3"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 7</span></span></span>
<span><span class="co">##          y  repl .edge_number .distance_on_edge .group .coord_x .coord_y</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  1.11       3            1            0.013<span style="text-decoration: underline;">4</span> 3        0.013<span style="text-decoration: underline;">4</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  0.774      3            1            0.023<span style="text-decoration: underline;">3</span> 3        0.023<span style="text-decoration: underline;">3</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  0.464      3            1            0.061<span style="text-decoration: underline;">8</span> 3        0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">1.62</span>       3            1            0.108  3        0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">1.48</span>       3            1            0.126  3        0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.815</span>      3            1            0.177  3        0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">1.25</span>       3            1            0.186  3        0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  0.064<span style="text-decoration: underline;">6</span>     3            1            0.202  3        0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  0.129      3            1            0.206  3        0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.881</span>      3            1            0.212  3        0.212         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 190 more rows</span></span></span></code></pre>
<p>We can also provide the group argument as a vector:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"3"</span>,<span class="st">"5"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 400 × 7</span></span></span>
<span><span class="co">##          y  repl .edge_number .distance_on_edge .group .coord_x .coord_y</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  1.11       3            1            0.013<span style="text-decoration: underline;">4</span> 3        0.013<span style="text-decoration: underline;">4</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  0.774      3            1            0.023<span style="text-decoration: underline;">3</span> 3        0.023<span style="text-decoration: underline;">3</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  0.464      3            1            0.061<span style="text-decoration: underline;">8</span> 3        0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">1.62</span>       3            1            0.108  3        0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">1.48</span>       3            1            0.126  3        0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.815</span>      3            1            0.177  3        0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">1.25</span>       3            1            0.186  3        0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  0.064<span style="text-decoration: underline;">6</span>     3            1            0.202  3        0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  0.129      3            1            0.206  3        0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.881</span>      3            1            0.212  3        0.212         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 390 more rows</span></span></span></code></pre>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method works similarly. We can plot the data
from a specific group by specifying which group we would like to
plot:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>data <span class="op">=</span> <span class="st">"y"</span>, group <span class="op">=</span> <span class="st">"3"</span><span class="op">)</span></span></code></pre></div>
<p><img src="metric_graph_data_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="more-advanced-grouping">More advanced grouping<a class="anchor" aria-label="anchor" href="#more-advanced-grouping"></a>
</h2>
<p>Besides being able to group data acoording to one column of the data,
we can also group the data with respect to several columns of the data.
Let us generate a new data set:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n.repl</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">y_repl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n.repl</span> <span class="op">*</span> <span class="va">graph</span><span class="op">$</span><span class="va">nE</span> <span class="op">*</span> <span class="va">obs_per_edge</span><span class="op">)</span></span>
<span><span class="va">repl_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n.repl</span>, each <span class="op">=</span> <span class="va">graph</span><span class="op">$</span><span class="va">nE</span> <span class="op">*</span> <span class="va">obs_per_edge</span><span class="op">)</span></span>
<span><span class="va">repl_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>,<span class="st">"d"</span>,<span class="st">"e"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">graph</span><span class="op">$</span><span class="va">nE</span> <span class="op">*</span> <span class="va">obs_per_edge</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_adv_grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y_repl</span>, </span>
<span>                  repl_1 <span class="op">=</span> <span class="va">repl_1</span>, repl_2 <span class="op">=</span> <span class="va">repl_2</span>,</span>
<span>                  edge_number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">obs_loc</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, times <span class="op">=</span> <span class="va">n.repl</span><span class="op">)</span>, </span>
<span>                  distance_on_edge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">obs_loc</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, times <span class="op">=</span> <span class="va">n.repl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Let us now add these observations on the graph and group them by
<code>c("repl_1","repl_2")</code>:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_adv_grp</span>, </span>
<span>                        normalized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                        clear_obs <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                        group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"repl_1"</span>, <span class="st">"repl_2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Adding observations...</span></span></code></pre>
<p>Let us take a look at the grouped variables. They are stored in the
<code>.group</code> column:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2,000 × 8</span></span></span>
<span><span class="co">##         y repl_1 repl_2 .edge_number .distance_on_edge .group .coord_x .coord_y</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  1.15       1 a                 1             0.206 1.a       0.206        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.529</span>      1 a                 1             0.266 1.a       0.266        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  0.344      1 a                 1             0.386 1.a       0.386        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>  0.921      1 a                 1             0.482 1.a       0.482        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.626</span>      1 a                 1             0.498 1.a       0.498        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>  0.760      1 a                 1             0.668 1.a       0.668        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  0.101      1 a                 1             0.789 1.a       0.789        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  1.31       1 a                 1             0.821 1.a       0.821        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">1.35</span>       1 a                 1             0.898 1.a       0.898        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">1.05</span>       1 a                 1             0.935 1.a       0.935        0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1,990 more rows</span></span></span></code></pre>
<p>Observe that the <code>group</code> variable is created, by default,
by pasting the group variables together with the <code>.</code> as
separator. We can change the separator using the <code>group_sep</code>
argument:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_adv_grp</span>, </span>
<span>                        normalized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                        clear_obs <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                        group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"repl_1"</span>, <span class="st">"repl_2"</span><span class="op">)</span>,</span>
<span>                        group_sep <span class="op">=</span> <span class="st">":"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Adding observations...</span></span></code></pre>
<p>Then,</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2,000 × 8</span></span></span>
<span><span class="co">##         y repl_1 repl_2 .edge_number .distance_on_edge .group .coord_x .coord_y</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  1.15       1 a                 1             0.206 1:a       0.206        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.529</span>      1 a                 1             0.266 1:a       0.266        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  0.344      1 a                 1             0.386 1:a       0.386        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>  0.921      1 a                 1             0.482 1:a       0.482        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.626</span>      1 a                 1             0.498 1:a       0.498        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>  0.760      1 a                 1             0.668 1:a       0.668        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  0.101      1 a                 1             0.789 1:a       0.789        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  1.31       1 a                 1             0.821 1:a       0.821        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">1.35</span>       1 a                 1             0.898 1:a       0.898        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">1.05</span>       1 a                 1             0.935 1:a       0.935        0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1,990 more rows</span></span></span></code></pre>
<p>To plot the data for a particular group, we simply select the group
variable we want to plot. Let us plot <code>y</code> for
<code>repl_1</code> equal to <code>3</code> and <code>repl_2</code>
equal to <code>c</code>:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>data <span class="op">=</span> <span class="st">"y"</span>, group <span class="op">=</span> <span class="st">"3:c"</span><span class="op">)</span></span></code></pre></div>
<p><img src="metric_graph_data_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="manipulating-data-from-metric-graphs-in-the-tidyverse-style">Manipulating data from metric graphs in the tidyverse style<a class="anchor" aria-label="anchor" href="#manipulating-data-from-metric-graphs-in-the-tidyverse-style"></a>
</h2>
<p>In this section we will present some data manipulation tools that are
implemented in metric graphs and can be safely used.</p>
<p>The tools are based on <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select()</a></code>,
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter()</a></code>,
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">dplyr::summarise()</a></code> and <code><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">tidyr::drop_na()</a></code>.</p>
<p>Let us generate a dataset that will be widely used throughout this
section and add this to the metric graph object. Observe that we are
replacing the existing data by setting <code>clear_obs</code> to
<code>TRUE</code>:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>, y2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, y3 <span class="op">=</span> <span class="va">y</span><span class="op">^</span><span class="fl">2</span>, y4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>       edge_number <span class="op">=</span> <span class="va">obs_loc</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, distance_on_edge <span class="op">=</span> <span class="va">obs_loc</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ordering to simplify presentation with NA data</span></span>
<span><span class="va">ord_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">df_tidy</span><span class="op">[[</span><span class="st">"edge_number"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                <span class="va">df_tidy</span><span class="op">[[</span><span class="st">"distance_on_edge"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">df_tidy</span> <span class="op">&lt;-</span> <span class="va">df_tidy</span><span class="op">[</span><span class="va">ord_idx</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># Setting some NA data</span></span>
<span><span class="va">df_tidy</span><span class="op">[[</span><span class="st">"y"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df_tidy</span><span class="op">[[</span><span class="st">"y2"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">df_tidy</span><span class="op">[[</span><span class="st">"y3"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df_tidy</span><span class="op">[[</span><span class="st">"y4"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">df_tidy</span><span class="op">[[</span><span class="st">"y2"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">df_tidy</span><span class="op">[[</span><span class="st">"y3"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_tidy</span>, clear_obs <span class="op">=</span> <span class="cn">TRUE</span>, normalized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Adding observations...</span></span></code></pre>
<p>Let us look at the complete data:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span>drop_all_na <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 9</span></span></span>
<span><span class="co">##         y     y2      y3     y4 .edge_number .distance_on_edge .group .coord_x</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>                1            0.013<span style="text-decoration: underline;">4</span>      1   0.013<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  2.09  <span style="color: #BB0000;">NA</span>      4.36    0.870            1            0.023<span style="text-decoration: underline;">3</span>      1   0.023<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  1.68   5.38  <span style="color: #BB0000;">NA</span>       0.994            1            0.061<span style="text-decoration: underline;">8</span>      1   0.061<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.528</span>  0.590  0.279  -<span style="color: #BB0000;">0.504</span>            1            0.108       1   0.108 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.180</span>  0.836  0.032<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.179</span>            1            0.126       1   0.126 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.462</span>  0.630  0.213  -<span style="color: #BB0000;">0.445</span>            1            0.177       1   0.177 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">1.52</span>   0.219  2.31   -<span style="color: #BB0000;">0.999</span>            1            0.186       1   0.186 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.655</span>  0.520  0.428  -<span style="color: #BB0000;">0.609</span>            1            0.202       1   0.202 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.636</span>  0.530  0.404  -<span style="color: #BB0000;">0.594</span>            1            0.206       1   0.206 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  1.34   3.83   1.80    0.974            1            0.212       1   0.212 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 190 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: .coord_y &lt;dbl&gt;</span></span></span></code></pre>
<div class="section level3">
<h3 id="select">select<a class="anchor" aria-label="anchor" href="#select"></a>
</h3>
<p>The verb <code>select</code> allows one to choose which columns to
keep or to remove.</p>
<p>For example, let us select the columns <code>y</code> and
<code>y2</code> from the metric graph dataset using the
<code><a href="../reference/select.metric_graph_data.html">select()</a></code> method:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="va">y</span>,<span class="va">y2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 199 × 7</span></span></span>
<span><span class="co">##         y     y2 .group .edge_number .distance_on_edge .coord_x .coord_y</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  2.09  <span style="color: #BB0000;">NA</span>          1            1            0.023<span style="text-decoration: underline;">3</span>   0.023<span style="text-decoration: underline;">3</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  1.68   5.38       1            1            0.061<span style="text-decoration: underline;">8</span>   0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.528</span>  0.590      1            1            0.108    0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.180</span>  0.836      1            1            0.126    0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.462</span>  0.630      1            1            0.177    0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">1.52</span>   0.219      1            1            0.186    0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.655</span>  0.520      1            1            0.202    0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.636</span>  0.530      1            1            0.206    0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  1.34   3.83       1            1            0.212    0.212         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.620</span>  0.538      1            1            0.266    0.266         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 189 more rows</span></span></span></code></pre>
<p>First, observe that this <code>select</code> verb is metric graph
friendly since it does not remove the columns related to spatial
locations.</p>
<p>Also observe that the first original row, that contains only
<code>NA</code> was removed by default. To return all the rows, we can
set the argument <code>.drop_all_na</code> to <code>FALSE</code>:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="va">y</span>, <span class="va">y2</span>, .drop_all_na <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 7</span></span></span>
<span><span class="co">##         y     y2 .group .edge_number .distance_on_edge .coord_x .coord_y</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          1            1            0.013<span style="text-decoration: underline;">4</span>   0.013<span style="text-decoration: underline;">4</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  2.09  <span style="color: #BB0000;">NA</span>          1            1            0.023<span style="text-decoration: underline;">3</span>   0.023<span style="text-decoration: underline;">3</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  1.68   5.38       1            1            0.061<span style="text-decoration: underline;">8</span>   0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.528</span>  0.590      1            1            0.108    0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.180</span>  0.836      1            1            0.126    0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.462</span>  0.630      1            1            0.177    0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">1.52</span>   0.219      1            1            0.186    0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.655</span>  0.520      1            1            0.202    0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.636</span>  0.530      1            1            0.206    0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  1.34   3.83       1            1            0.212    0.212         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 190 more rows</span></span></span></code></pre>
<p>Further, observe that the second row also contain an <code>NA</code>
value in <code>y2</code>. To remove all the rows that contain
<code>NA</code> for at least one variable, we can set the argument
<code>.drop_na</code> to <code>TRUE</code>:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="va">y</span>, <span class="va">y2</span>, .drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 198 × 7</span></span></span>
<span><span class="co">##         y    y2 .group .edge_number .distance_on_edge .coord_x .coord_y</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  1.68  5.38       1            1            0.061<span style="text-decoration: underline;">8</span>   0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.528</span> 0.590      1            1            0.108    0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.180</span> 0.836      1            1            0.126    0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.462</span> 0.630      1            1            0.177    0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">1.52</span>  0.219      1            1            0.186    0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.655</span> 0.520      1            1            0.202    0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.636</span> 0.530      1            1            0.206    0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  1.34  3.83       1            1            0.212    0.212         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.620</span> 0.538      1            1            0.266    0.266         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.100</span> 0.905      1            1            0.267    0.267         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 188 more rows</span></span></span></code></pre>
<p>Moreover, if we want to remove a column, we can simply use the
<code><a href="../reference/select.metric_graph_data.html">select()</a></code> method together with adding a minus sign
<code>-</code> in front of the column we want to be removed. For
example, to remove <code>y2</code>, we can do:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">y2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 199 × 8</span></span></span>
<span><span class="co">##         y      y3     y4 .edge_number .distance_on_edge .group .coord_x .coord_y</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  2.09   4.36    0.870            1            0.023<span style="text-decoration: underline;">3</span>      1   0.023<span style="text-decoration: underline;">3</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  1.68  <span style="color: #BB0000;">NA</span>       0.994            1            0.061<span style="text-decoration: underline;">8</span>      1   0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.528</span>  0.279  -<span style="color: #BB0000;">0.504</span>            1            0.108       1   0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.180</span>  0.032<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.179</span>            1            0.126       1   0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.462</span>  0.213  -<span style="color: #BB0000;">0.445</span>            1            0.177       1   0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">1.52</span>   2.31   -<span style="color: #BB0000;">0.999</span>            1            0.186       1   0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.655</span>  0.428  -<span style="color: #BB0000;">0.609</span>            1            0.202       1   0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.636</span>  0.404  -<span style="color: #BB0000;">0.594</span>            1            0.206       1   0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  1.34   1.80    0.974            1            0.212       1   0.212         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.620</span>  0.385  -<span style="color: #BB0000;">0.581</span>            1            0.266       1   0.266         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 189 more rows</span></span></span></code></pre>
<p>Alternatively, we can combine the <code><a href="../reference/select.metric_graph_data.html">select()</a></code> function with
the output of <code>get_data()</code> to obtain the same results:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/select.metric_graph_data.html">select</a></span><span class="op">(</span><span class="va">y</span>,<span class="va">y2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 199 × 7</span></span></span>
<span><span class="co">##         y     y2 .group .edge_number .distance_on_edge .coord_x .coord_y</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  2.09  <span style="color: #BB0000;">NA</span>          1            1            0.023<span style="text-decoration: underline;">3</span>   0.023<span style="text-decoration: underline;">3</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  1.68   5.38       1            1            0.061<span style="text-decoration: underline;">8</span>   0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.528</span>  0.590      1            1            0.108    0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.180</span>  0.836      1            1            0.126    0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.462</span>  0.630      1            1            0.177    0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">1.52</span>   0.219      1            1            0.186    0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.655</span>  0.520      1            1            0.202    0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.636</span>  0.530      1            1            0.206    0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  1.34   3.83       1            1            0.212    0.212         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.620</span>  0.538      1            1            0.266    0.266         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 189 more rows</span></span></span></code></pre>
<p>Observe that the spatial locations columns were not removed as well.
To avoid removing <code>NA</code> variables, we need to set the argument
<code>drop_all_na</code> to <code>FALSE</code> when using the
<code>get_data()</code> method:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span>drop_all_na <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/select.metric_graph_data.html">select</a></span><span class="op">(</span><span class="va">y</span>,<span class="va">y2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 7</span></span></span>
<span><span class="co">##         y     y2 .group .edge_number .distance_on_edge .coord_x .coord_y</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          1            1            0.013<span style="text-decoration: underline;">4</span>   0.013<span style="text-decoration: underline;">4</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  2.09  <span style="color: #BB0000;">NA</span>          1            1            0.023<span style="text-decoration: underline;">3</span>   0.023<span style="text-decoration: underline;">3</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  1.68   5.38       1            1            0.061<span style="text-decoration: underline;">8</span>   0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.528</span>  0.590      1            1            0.108    0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.180</span>  0.836      1            1            0.126    0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.462</span>  0.630      1            1            0.177    0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">1.52</span>   0.219      1            1            0.186    0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.655</span>  0.520      1            1            0.202    0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.636</span>  0.530      1            1            0.206    0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  1.34   3.83       1            1            0.212    0.212         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 190 more rows</span></span></span></code></pre>
<p>We can proceed similarly to remove <code>y2</code>:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/select.metric_graph_data.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">y2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 199 × 8</span></span></span>
<span><span class="co">##         y      y3     y4 .edge_number .distance_on_edge .group .coord_x .coord_y</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  2.09   4.36    0.870            1            0.023<span style="text-decoration: underline;">3</span>      1   0.023<span style="text-decoration: underline;">3</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  1.68  <span style="color: #BB0000;">NA</span>       0.994            1            0.061<span style="text-decoration: underline;">8</span>      1   0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.528</span>  0.279  -<span style="color: #BB0000;">0.504</span>            1            0.108       1   0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.180</span>  0.032<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.179</span>            1            0.126       1   0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.462</span>  0.213  -<span style="color: #BB0000;">0.445</span>            1            0.177       1   0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">1.52</span>   2.31   -<span style="color: #BB0000;">0.999</span>            1            0.186       1   0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.655</span>  0.428  -<span style="color: #BB0000;">0.609</span>            1            0.202       1   0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.636</span>  0.404  -<span style="color: #BB0000;">0.594</span>            1            0.206       1   0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  1.34   1.80    0.974            1            0.212       1   0.212         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.620</span>  0.385  -<span style="color: #BB0000;">0.581</span>            1            0.266       1   0.266         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 189 more rows</span></span></span></code></pre>
<p>Finally, observe that this is a modification of
<code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select()</a></code> made to be user-friendly to metric graphs,
since it keeps the spatial locations. For example, if we use the
standard version of <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select()</a></code> the result is
different:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">:::</span><span class="fu">select.data.frame</span><span class="op">(</span><span class="va">y</span>,<span class="va">y2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 199 × 2</span></span></span>
<span><span class="co">##         y     y2</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  2.09  <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  1.68   5.38 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.528</span>  0.590</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.180</span>  0.836</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.462</span>  0.630</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">1.52</span>   0.219</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.655</span>  0.520</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.636</span>  0.530</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  1.34   3.83 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.620</span>  0.538</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 189 more rows</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="filter">filter<a class="anchor" aria-label="anchor" href="#filter"></a>
</h3>
<p>The <code>filter</code> verb selects rows based on conditions on the
variables. For example, let us select the variables that are on
<code>edge_number</code> 3, with <code>distance_on_edge</code> greater
than 0.5:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filtered_data</span> <span class="op">&lt;-</span> <span class="va">graph</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">`.edge_number`</span> <span class="op">==</span> <span class="fl">3</span>, <span class="va">`.distance_on_edge`</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>We can plot the result using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method together
with the <code>newdata</code> argument to supply the modified
dataset:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>data <span class="op">=</span> <span class="st">"y"</span>, newdata <span class="op">=</span> <span class="va">filtered_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="metric_graph_data_files/figure-html/unnamed-chunk-43-1.png" width="700"></p>
<p>The behavior with <code>NA</code> variables is exactly the same as
with the <code><a href="../reference/select.metric_graph_data.html">select()</a></code> method. For example, we can remove the
rows that contain <code>NA</code> variables by setting
<code>drop_na</code> to <code>TRUE</code>:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">filter</span><span class="op">(</span><span class="va">y</span> <span class="op">&gt;</span> <span class="fl">1</span>, .drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 30 × 9</span></span></span>
<span><span class="co">##        y    y2    y3    y4 .edge_number .distance_on_edge .group .coord_x</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  1.34  3.83  1.80 0.974            1             0.212      1    0.212</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  1.18  3.24  1.38 0.923            1             0.647      1    0.647</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  1.43  4.19  2.05 0.990            1             0.687      1    0.687</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>  1.77  5.85  3.12 0.981            1             0.898      1    0.898</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  2.21  9.08  4.87 0.805            2             0.258      1    0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>  1.00  2.72  1.00 0.841            2             0.316      1    0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  2.31 10.1   5.33 0.740            2             0.339      1    0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  2.08  7.97  4.31 0.875            2             0.390      1    0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  1.87  6.48  3.49 0.956            2             0.407      1    0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  1.44  4.23  2.08 0.992            2             0.455      1    0    </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 20 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: .coord_y &lt;dbl&gt;</span></span></span></code></pre>
<p>To conclude, we can also use the <code><a href="../reference/filter.metric_graph_data.html">filter()</a></code> function on
top of the result of the <code>get_data()</code> method:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filtered_data2</span> <span class="op">&lt;-</span> <span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/filter.metric_graph_data.html">filter</a></span><span class="op">(</span><span class="va">y</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Let us plot:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>data <span class="op">=</span> <span class="st">"y"</span>, newdata <span class="op">=</span> <span class="va">filtered_data2</span><span class="op">)</span></span></code></pre></div>
<p><img src="metric_graph_data_files/figure-html/unnamed-chunk-46-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="mutate">mutate<a class="anchor" aria-label="anchor" href="#mutate"></a>
</h3>
<p>The <code>mutate</code> verb creates new columns, or modify existing
columns, as functions of the existing columns. Let us create a new
column, <code>new_y</code>, obtained as the sum of <code>y</code> and
<code>y2</code>:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">mutate</span><span class="op">(</span>new_y <span class="op">=</span> <span class="va">y</span><span class="op">+</span><span class="va">y2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 199 × 10</span></span></span>
<span><span class="co">##         y     y2      y3     y4 .edge_number .distance_on_edge .group .coord_x</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  2.09  <span style="color: #BB0000;">NA</span>      4.36    0.870            1            0.023<span style="text-decoration: underline;">3</span>      1   0.023<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  1.68   5.38  <span style="color: #BB0000;">NA</span>       0.994            1            0.061<span style="text-decoration: underline;">8</span>      1   0.061<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.528</span>  0.590  0.279  -<span style="color: #BB0000;">0.504</span>            1            0.108       1   0.108 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.180</span>  0.836  0.032<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.179</span>            1            0.126       1   0.126 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.462</span>  0.630  0.213  -<span style="color: #BB0000;">0.445</span>            1            0.177       1   0.177 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">1.52</span>   0.219  2.31   -<span style="color: #BB0000;">0.999</span>            1            0.186       1   0.186 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.655</span>  0.520  0.428  -<span style="color: #BB0000;">0.609</span>            1            0.202       1   0.202 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.636</span>  0.530  0.404  -<span style="color: #BB0000;">0.594</span>            1            0.206       1   0.206 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  1.34   3.83   1.80    0.974            1            0.212       1   0.212 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.620</span>  0.538  0.385  -<span style="color: #BB0000;">0.581</span>            1            0.266       1   0.266 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 189 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 2 more variables: .coord_y &lt;dbl&gt;, new_y &lt;dbl&gt;</span></span></span></code></pre>
<p>The behavior with <code>NA</code> data is the same as for the
<code><a href="../reference/filter.metric_graph_data.html">filter()</a></code> and <code><a href="../reference/select.metric_graph_data.html">select()</a></code> methods. For example, if
we want to keep all the data, we can set <code>.drop_all_na</code> to
`FALSE:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">mutate</span><span class="op">(</span>new_y <span class="op">=</span> <span class="va">y</span><span class="op">+</span><span class="va">y2</span>, .drop_all_na<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 10</span></span></span>
<span><span class="co">##         y     y2      y3     y4 .edge_number .distance_on_edge .group .coord_x</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>                1            0.013<span style="text-decoration: underline;">4</span>      1   0.013<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  2.09  <span style="color: #BB0000;">NA</span>      4.36    0.870            1            0.023<span style="text-decoration: underline;">3</span>      1   0.023<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  1.68   5.38  <span style="color: #BB0000;">NA</span>       0.994            1            0.061<span style="text-decoration: underline;">8</span>      1   0.061<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.528</span>  0.590  0.279  -<span style="color: #BB0000;">0.504</span>            1            0.108       1   0.108 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.180</span>  0.836  0.032<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.179</span>            1            0.126       1   0.126 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.462</span>  0.630  0.213  -<span style="color: #BB0000;">0.445</span>            1            0.177       1   0.177 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">1.52</span>   0.219  2.31   -<span style="color: #BB0000;">0.999</span>            1            0.186       1   0.186 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.655</span>  0.520  0.428  -<span style="color: #BB0000;">0.609</span>            1            0.202       1   0.202 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.636</span>  0.530  0.404  -<span style="color: #BB0000;">0.594</span>            1            0.206       1   0.206 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  1.34   3.83   1.80    0.974            1            0.212       1   0.212 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 190 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 2 more variables: .coord_y &lt;dbl&gt;, new_y &lt;dbl&gt;</span></span></span></code></pre>
<p>Let us modify the variable <code>y3</code> and at the same time
remove all the <code>NA</code>:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">mutate</span><span class="op">(</span>y3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">y</span><span class="op">&gt;</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>, .drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 197 × 9</span></span></span>
<span><span class="co">##         y    y2    y3     y4 .edge_number .distance_on_edge .group .coord_x</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">0.528</span> 0.590    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.504</span>            1             0.108      1    0.108</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.180</span> 0.836    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.179</span>            1             0.126      1    0.126</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.462</span> 0.630    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.445</span>            1             0.177      1    0.177</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">1.52</span>  0.219    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.999</span>            1             0.186      1    0.186</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.655</span> 0.520    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.609</span>            1             0.202      1    0.202</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.636</span> 0.530    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.594</span>            1             0.206      1    0.206</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  1.34  3.83      1  0.974            1             0.212      1    0.212</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.620</span> 0.538    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.581</span>            1             0.266      1    0.266</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.100</span> 0.905    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.100</span>            1             0.267      1    0.267</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.324</span> 0.723    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.319</span>            1             0.340      1    0.340</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 187 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: .coord_y &lt;dbl&gt;</span></span></span></code></pre>
<p>Finally, we can also apply the <code><a href="../reference/mutate.metric_graph_data.html">mutate()</a></code> function the
result of the <code>get_data()</code> method, and also pipe it to the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method (we are also changing the scale to
discrete):</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/mutate.metric_graph_data.html">mutate</a></span><span class="op">(</span>new_y <span class="op">=</span> <span class="va">y</span><span class="op">+</span><span class="va">y2</span>, </span>
<span>                        y3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">y</span><span class="op">&gt;</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>                        <span class="va">graph</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>data <span class="op">=</span> <span class="st">"y3"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_colour_discrete</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="metric_graph_data_files/figure-html/unnamed-chunk-50-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="summarise">summarise<a class="anchor" aria-label="anchor" href="#summarise"></a>
</h3>
<p>The <code>summarise</code> verb creates summaries of selected columns
based on groupings. For metric graphs, the groups always include the
edge number (<code>.edge_number</code>) and relative distance on edge
(<code>.distance_on_edge</code>). By using the argument
<code>.include_graph_groups</code>, the internal metric graph group
variable, namely <code>.group</code>, will also be added to the
<code><a href="../reference/summarise.metric_graph_data.html">summarise()</a></code> group. Finally, additional groups can be passed
by the <code>.groups</code> argument.</p>
<p>To illustrate, we will use the <code>data.frame</code> from the group
example:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_data_repl</span>, </span>
<span>                normalized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                clear_obs <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                group <span class="op">=</span> <span class="st">"repl"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Adding observations...</span></span></code></pre>
<p>We can see the data:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1,000 × 7</span></span></span>
<span><span class="co">##         y  repl .edge_number .distance_on_edge .group .coord_x .coord_y</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  1.50      1            1            0.013<span style="text-decoration: underline;">4</span> 1        0.013<span style="text-decoration: underline;">4</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">1.79</span>      1            1            0.023<span style="text-decoration: underline;">3</span> 1        0.023<span style="text-decoration: underline;">3</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  0.488     1            1            0.061<span style="text-decoration: underline;">8</span> 1        0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.385</span>     1            1            0.108  1        0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  0.905     1            1            0.126  1        0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.145</span>     1            1            0.177  1        0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  2.00      1            1            0.186  1        0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">1.16</span>      1            1            0.202  1        0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  0.879     1            1            0.206  1        0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.816</span>     1            1            0.212  1        0.212         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 990 more rows</span></span></span></code></pre>
<p>Let us <code>summarise</code> the data by obtaining the mean of
<code>y</code> at each location across all groups:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">summarise</span><span class="op">(</span>mean_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 6</span></span></span>
<span><span class="co">##    .edge_number .distance_on_edge .coord_x .coord_y  mean_y .group</span></span>
<span><span class="co">##           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>            1            0.013<span style="text-decoration: underline;">4</span>   0.013<span style="text-decoration: underline;">4</span>        0  0.578       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>            1            0.023<span style="text-decoration: underline;">3</span>   0.023<span style="text-decoration: underline;">3</span>        0  0.407       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>            1            0.061<span style="text-decoration: underline;">8</span>   0.061<span style="text-decoration: underline;">8</span>        0  0.638       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>            1            0.108    0.108         0 -<span style="color: #BB0000;">0.327</span>       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>            1            0.126    0.126         0 -<span style="color: #BB0000;">0.942</span>       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>            1            0.177    0.177         0 -<span style="color: #BB0000;">0.156</span>       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>            1            0.186    0.186         0  0.092<span style="text-decoration: underline;">5</span>      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>            1            0.202    0.202         0 -<span style="color: #BB0000;">0.054</span><span style="color: #BB0000; text-decoration: underline;">8</span>      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>            1            0.206    0.206         0  0.345       1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>            1            0.212    0.212         0 -<span style="color: #BB0000;">0.546</span>       1</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 190 more rows</span></span></span></code></pre>
<p>Let us now obtain the standard deviation of <code>y</code> at each
location and plot it:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">summarise</span><span class="op">(</span>sd_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="va">graph</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>data <span class="op">=</span> <span class="st">"sd_y"</span><span class="op">)</span></span></code></pre></div>
<p><img src="metric_graph_data_files/figure-html/unnamed-chunk-54-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="drop_na">drop_na<a class="anchor" aria-label="anchor" href="#drop_na"></a>
</h3>
<p>The <code>drop_na</code> verb removes rows that contain
<code>NA</code> for the selected columns. To illustrate, let us add the
<code>df_tidy</code> back to the metric graph, replacing the existing
dataset:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_tidy</span>, clear_obs<span class="op">=</span><span class="cn">TRUE</span>, normalized<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Adding observations...</span></span></code></pre>
<p>Now, let us take a look at this dataset:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span>drop_all_na <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 9</span></span></span>
<span><span class="co">##         y     y2      y3     y4 .edge_number .distance_on_edge .group .coord_x</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>                1            0.013<span style="text-decoration: underline;">4</span>      1   0.013<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  2.09  <span style="color: #BB0000;">NA</span>      4.36    0.870            1            0.023<span style="text-decoration: underline;">3</span>      1   0.023<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  1.68   5.38  <span style="color: #BB0000;">NA</span>       0.994            1            0.061<span style="text-decoration: underline;">8</span>      1   0.061<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.528</span>  0.590  0.279  -<span style="color: #BB0000;">0.504</span>            1            0.108       1   0.108 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.180</span>  0.836  0.032<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.179</span>            1            0.126       1   0.126 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.462</span>  0.630  0.213  -<span style="color: #BB0000;">0.445</span>            1            0.177       1   0.177 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">1.52</span>   0.219  2.31   -<span style="color: #BB0000;">0.999</span>            1            0.186       1   0.186 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.655</span>  0.520  0.428  -<span style="color: #BB0000;">0.609</span>            1            0.202       1   0.202 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.636</span>  0.530  0.404  -<span style="color: #BB0000;">0.594</span>            1            0.206       1   0.206 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  1.34   3.83   1.80    0.974            1            0.212       1   0.212 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 190 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: .coord_y &lt;dbl&gt;</span></span></span></code></pre>
<p>For example, let us remove the rows such that <code>y3</code> is
<code>NA</code>, we simply apply the <code><a href="../reference/drop_na.metric_graph_data.html">drop_na()</a></code> method
passing the column <code>y3</code>:</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">drop_na</span><span class="op">(</span><span class="va">y3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 198 × 9</span></span></span>
<span><span class="co">##         y     y2     y3     y4 .edge_number .distance_on_edge .group .coord_x</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  2.09  <span style="color: #BB0000;">NA</span>     4.36    0.870            1            0.023<span style="text-decoration: underline;">3</span>      1   0.023<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.528</span>  0.590 0.279  -<span style="color: #BB0000;">0.504</span>            1            0.108       1   0.108 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.180</span>  0.836 0.032<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.179</span>            1            0.126       1   0.126 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.462</span>  0.630 0.213  -<span style="color: #BB0000;">0.445</span>            1            0.177       1   0.177 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">1.52</span>   0.219 2.31   -<span style="color: #BB0000;">0.999</span>            1            0.186       1   0.186 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.655</span>  0.520 0.428  -<span style="color: #BB0000;">0.609</span>            1            0.202       1   0.202 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.636</span>  0.530 0.404  -<span style="color: #BB0000;">0.594</span>            1            0.206       1   0.206 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  1.34   3.83  1.80    0.974            1            0.212       1   0.212 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.620</span>  0.538 0.385  -<span style="color: #BB0000;">0.581</span>            1            0.266       1   0.266 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.100</span>  0.905 0.010<span style="text-decoration: underline;">0</span> -<span style="color: #BB0000;">0.100</span>            1            0.267       1   0.267 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 188 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: .coord_y &lt;dbl&gt;</span></span></span></code></pre>
<p>We can also remove the rows such that either <code>y2</code> or
<code>y3</code> is <code>NA</code>:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">drop_na</span><span class="op">(</span><span class="va">y2</span>, <span class="va">y3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 197 × 9</span></span></span>
<span><span class="co">##         y    y2     y3     y4 .edge_number .distance_on_edge .group .coord_x</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">0.528</span> 0.590 0.279  -<span style="color: #BB0000;">0.504</span>            1             0.108      1    0.108</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.180</span> 0.836 0.032<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.179</span>            1             0.126      1    0.126</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.462</span> 0.630 0.213  -<span style="color: #BB0000;">0.445</span>            1             0.177      1    0.177</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">1.52</span>  0.219 2.31   -<span style="color: #BB0000;">0.999</span>            1             0.186      1    0.186</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.655</span> 0.520 0.428  -<span style="color: #BB0000;">0.609</span>            1             0.202      1    0.202</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.636</span> 0.530 0.404  -<span style="color: #BB0000;">0.594</span>            1             0.206      1    0.206</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  1.34  3.83  1.80    0.974            1             0.212      1    0.212</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.620</span> 0.538 0.385  -<span style="color: #BB0000;">0.581</span>            1             0.266      1    0.266</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.100</span> 0.905 0.010<span style="text-decoration: underline;">0</span> -<span style="color: #BB0000;">0.100</span>            1             0.267      1    0.267</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.324</span> 0.723 0.105  -<span style="color: #BB0000;">0.319</span>            1             0.340      1    0.340</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 187 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: .coord_y &lt;dbl&gt;</span></span></span></code></pre>
<p>If we simply run the <code><a href="../reference/drop_na.metric_graph_data.html">drop_na()</a></code> method, this is
equivalent to run the <code>get_data()</code> method with the argument
<code>drop_na</code> set to <code>TRUE</code>:</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span>, <span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span>drop_na<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Finally, we can also directly apply the <code><a href="../reference/drop_na.metric_graph_data.html">drop_na()</a></code>
function to the result of the <code>get_data()</code> method:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span>drop_all_na <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/drop_na.metric_graph_data.html">drop_na</a></span><span class="op">(</span><span class="va">y3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 198 × 9</span></span></span>
<span><span class="co">##         y     y2     y3     y4 .edge_number .distance_on_edge .group .coord_x</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  2.09  <span style="color: #BB0000;">NA</span>     4.36    0.870            1            0.023<span style="text-decoration: underline;">3</span>      1   0.023<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.528</span>  0.590 0.279  -<span style="color: #BB0000;">0.504</span>            1            0.108       1   0.108 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.180</span>  0.836 0.032<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.179</span>            1            0.126       1   0.126 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.462</span>  0.630 0.213  -<span style="color: #BB0000;">0.445</span>            1            0.177       1   0.177 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">1.52</span>   0.219 2.31   -<span style="color: #BB0000;">0.999</span>            1            0.186       1   0.186 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.655</span>  0.520 0.428  -<span style="color: #BB0000;">0.609</span>            1            0.202       1   0.202 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.636</span>  0.530 0.404  -<span style="color: #BB0000;">0.594</span>            1            0.206       1   0.206 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  1.34   3.83  1.80    0.974            1            0.212       1   0.212 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.620</span>  0.538 0.385  -<span style="color: #BB0000;">0.581</span>            1            0.266       1   0.266 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.100</span>  0.905 0.010<span style="text-decoration: underline;">0</span> -<span style="color: #BB0000;">0.100</span>            1            0.267       1   0.267 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 188 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: .coord_y &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="combining-multiple-verbs">Combining multiple verbs<a class="anchor" aria-label="anchor" href="#combining-multiple-verbs"></a>
</h3>
<p>The resulting data from applying the previous verbs are safe in the
sense that they are friendly to the metric graph environment. Thus, the
result after applying one verb can be used as input of any of the
remaining verbs.</p>
<p>For this example we will consider the <code>df_data_repl</code>
dataset. Let us add to the graph (replacing the existing data):</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_data_repl</span>, </span>
<span>                        normalized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                        clear_obs <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                        group <span class="op">=</span> <span class="st">"repl"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Adding observations...</span></span></code></pre>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span>drop_all_na <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1,000 × 7</span></span></span>
<span><span class="co">##         y  repl .edge_number .distance_on_edge .group .coord_x .coord_y</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  1.50      1            1            0.013<span style="text-decoration: underline;">4</span> 1        0.013<span style="text-decoration: underline;">4</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">1.79</span>      1            1            0.023<span style="text-decoration: underline;">3</span> 1        0.023<span style="text-decoration: underline;">3</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  0.488     1            1            0.061<span style="text-decoration: underline;">8</span> 1        0.061<span style="text-decoration: underline;">8</span>        0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.385</span>     1            1            0.108  1        0.108         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  0.905     1            1            0.126  1        0.126         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.145</span>     1            1            0.177  1        0.177         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  2.00      1            1            0.186  1        0.186         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">1.16</span>      1            1            0.202  1        0.202         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  0.879     1            1            0.206  1        0.206         0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.816</span>     1            1            0.212  1        0.212         0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 990 more rows</span></span></span></code></pre>
<p>We will now create a new variable <code>new_y</code> which is the
exponential of <code>y</code>, then filter the data to be on edges
<code>1</code> and <code>2</code>, summarise to get the means of
<code>new_y</code> at all positions (across the different groups, from
the <code>_.group</code> variable) and plot it:</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">mutate</span><span class="op">(</span>new_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/filter.metric_graph_data.html">filter</a></span><span class="op">(</span><span class="va">`.edge_number`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>            <span class="fu"><a href="../reference/summarise.metric_graph_data.html">summarise</a></span><span class="op">(</span>mean_new_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">new_y</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>            <span class="va">graph</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>data <span class="op">=</span> <span class="st">"mean_new_y"</span><span class="op">)</span></span></code></pre></div>
<p><img src="metric_graph_data_files/figure-html/unnamed-chunk-62-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="replacing-the-data-in-the-metric-graph-by-manipulated-data">Replacing the data in the metric graph by manipulated data<a class="anchor" aria-label="anchor" href="#replacing-the-data-in-the-metric-graph-by-manipulated-data"></a>
</h2>
<p>Let us suppose we want to replace the internal data by the data
obtained from these manipulations. This is very simple, all we need to
do is to pass the resulting data to the <code>data</code> argument from
the <code>add_observations()</code> method. It is important to note that
if the input is the result of those verbs, <code>mutate</code>,
<code>select</code>, <code>filter</code>, <code>summarise</code> or
<code>drop_na</code>, or any combination of them, then there is no need
to set any of the other arguments of the <code>add_observations()</code>
method, one should simply supply the <code>data</code> argument with
such dataset. For example, let us consider the dataset from the previous
section. We will replace the data, so we will set <code>clear_obs</code>
to <code>TRUE</code>:</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="va">graph</span><span class="op">$</span><span class="fu">mutate</span><span class="op">(</span>new_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>                        <span class="fu"><a href="../reference/filter.metric_graph_data.html">filter</a></span><span class="op">(</span><span class="va">`.edge_number`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>                                <span class="fu"><a href="../reference/summarise.metric_graph_data.html">summarise</a></span><span class="op">(</span>mean_new_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">new_y</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                clear_obs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Adding observations...</span></span></code></pre>
<p>We can now observe the result:</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 100 × 6</span></span></span>
<span><span class="co">##    .coord_x .coord_y mean_new_y .edge_number .distance_on_edge .group</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>   0.013<span style="text-decoration: underline;">4</span>        0      3.15             1            0.013<span style="text-decoration: underline;">4</span> 1     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>   0.023<span style="text-decoration: underline;">3</span>        0      2.43             1            0.023<span style="text-decoration: underline;">3</span> 1     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>   0.061<span style="text-decoration: underline;">8</span>        0      1.92             1            0.061<span style="text-decoration: underline;">8</span> 1     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>   0.108         0      0.931            1            0.108  1     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   0.126         0      0.814            1            0.126  1     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   0.177         0      0.968            1            0.177  1     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   0.186         0      2.40             1            0.186  1     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   0.202         0      1.24             1            0.202  1     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>   0.206         0      2.60             1            0.206  1     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>   0.212         0      0.643            1            0.212  1     </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 90 more rows</span></span></span></code></pre>
<p>We can also save it to a separate variable and use as input:</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="va">graph</span><span class="op">$</span><span class="fu">mutate</span><span class="op">(</span>even_newer_y <span class="op">=</span> <span class="va">mean_new_y</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">graph</span><span class="op">$</span><span class="fu">add_observations</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_temp</span>, clear_obs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Adding observations...</span></span></code></pre>
<p>We can check that it was properly added:</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 100 × 7</span></span></span>
<span><span class="co">##    .coord_x .coord_y mean_new_y even_newer_y .edge_number .distance_on_edge</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>   0.013<span style="text-decoration: underline;">4</span>        0      3.15         9.90             1            0.013<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>   0.023<span style="text-decoration: underline;">3</span>        0      2.43         5.89             1            0.023<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>   0.061<span style="text-decoration: underline;">8</span>        0      1.92         3.69             1            0.061<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>   0.108         0      0.931        0.867            1            0.108 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   0.126         0      0.814        0.663            1            0.126 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   0.177         0      0.968        0.937            1            0.177 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   0.186         0      2.40         5.76             1            0.186 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   0.202         0      1.24         1.53             1            0.202 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>   0.206         0      2.60         6.73             1            0.206 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>   0.212         0      0.643        0.413            1            0.212 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 90 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: .group &lt;chr&gt;</span></span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Bolin, Alexandre Simas, Jonas Wallin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
